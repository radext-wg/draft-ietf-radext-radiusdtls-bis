<!DOCTYPE html>
<html lang="en" class="Internet-Draft">
<head>
<meta charset="utf-8">
<meta content="Common,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>(Datagram) Transport Layer Security ((D)TLS Encryption for RADIUS</title>
<meta content="Jan-Frederik Rieckers" name="author">
<meta content="Stefan Winter" name="author">
<meta content="
       This document specifies a transport profile for RADIUS using Transport Layer Security (TLS) over TCP or Datagram Transport Layer Security (DTLS) over UDP as the transport protocol.
This enables encrypting the RADIUS traffic as well as dynamic trust relationships between RADIUS servers.
The specification obsoletes the experimental specifications in RFC 6614 (RADIUS/TLS) and RFC 7360 (RADIUS/DTLS) and combines them in this specification. 
    " name="description">
<meta content="xml2rfc 3.27.0" name="generator">
<meta content="RADIUS" name="keyword">
<meta content="TLS" name="keyword">
<meta content="draft-ietf-radext-radiusdtls-bis-latest" name="ietf.draft">
<!-- Generator version information:
  xml2rfc 3.27.0
    Python 3.12.9
    ConfigArgParse 1.7
    google-i18n-address 3.1.1
    intervaltree 3.1.0
    Jinja2 3.1.5
    lxml 5.3.0
    platformdirs 4.3.6
    pycountry 24.6.1
    PyYAML 6.0.2
    requests 2.32.3
    setuptools 70.3.0
    wcwidth 0.2.13
-->
<link href="draft-ietf-radext-radiusdtls-bis.xml" rel="alternate" type="application/rfc+xml">
<link href="#copyright" rel="license">
<style type="text/css">@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}

@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-cyrillic.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-cyrillic.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Lora SemiBold'), local('Lora-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-semibold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Oxygen Mono';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Oxygen Mono'), local('OxygenMono-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/oxygenmono-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Oxygen Mono';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Oxygen Mono'), local('OxygenMono-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/oxygenmono-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C8A, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-cyrillic.woff2') format('woff2');
  unicode-range: U+0301, U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-greek.woff2') format('woff2');
  unicode-range: U+0370-0377, U+037A-037F, U+0384-038A, U+038C, U+038E-03A1, U+03A3-03FF;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-02BA, U+02BD-02C5, U+02C7-02CC, U+02CE-02D7, U+02DD-02FF, U+0304, U+0308, U+0329, U+1D00-1DBF, U+1E00-1E9F, U+1EF2-1EFF, U+2020, U+20A0-20AB, U+20AD-20C0, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+0304, U+0308, U+0329, U+2000-206F, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C8A, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-cyrillic.woff2') format('woff2');
  unicode-range: U+0301, U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-greek.woff2') format('woff2');
  unicode-range: U+0370-0377, U+037A-037F, U+0384-038A, U+038C, U+038E-03A1, U+03A3-03FF;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-02BA, U+02BD-02C5, U+02C7-02CC, U+02CE-02D7, U+02DD-02FF, U+0304, U+0308, U+0329, U+1D00-1DBF, U+1E00-1E9F, U+1EF2-1EFF, U+2020, U+20A0-20AB, U+20AD-20C0, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+0304, U+0308, U+0329, U+2000-206F, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

:root {
  color-scheme: light dark;
  --background-color: #fff;
  --text-color: #222;
  --title-color: #191919;
  --link-color: #2a6496;
  --highlight-color: #f9f9f9;
  --line-color: #eee;
  --pilcrow-weak: #ddd;
  --pilcrow-strong: #bbb;
  --small-font-size: 14.5px;
  --font-mono: 'Oxygen Mono', monospace;
  --font-title: "Sofia Sans Semi Condensed", sans-serif;
  scrollbar-color: #bbb #eee;
}
body {
  max-width: 600px;
  margin: 75px auto;
  padding: 0 5px;
  color: var(--text-color);
  background-color: var(--background-color);
  font: 16px/22px "Lora", serif;
  scroll-behavior: smooth;
}

.ears {
  display: none;
}

/* headings */
section {
  clear: both;
}
.section-number {
  padding-right: 0.5em;
}
h1, h2, h3, h4, h5, h6 {
  font-family: var(--font-title);
  font-weight: 680;
  margin: 0.8em 0 0.3em;
  font-size-adjust: 0.5;
  color: var(--title-color);
}
h1#title {
  font-size: 32px;
  line-height: 40px;
  clear: both;
}
h1#title, h1#rfcnum {
  margin: 1.5em 0 0.2em;
}
h1#rfcnum + h1#title {
  margin: 0.2em 0;
}

h1, h2, h3 {
  font-size: 22px;
  line-height: 27px;
}
h4, h5, h6 {
  font-size: 20px;
  line-height: 24px;
}

/* general structure */
.author {
  padding-bottom: 0.3em;
  vertical-align: top;
}
#abstract+p {
  font-size: 18px;
  line-height: 24px;
}
#abstract+p code, #abstract+p samp, #abstract+p tt {
  font-size: 16px;
  line-height: 0;
}

p {
  padding: 0;
  margin: 0.5em 0;
  text-align: left;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  padding: 0.5em 1em 0;
  margin-bottom: 0.5em;
}
.alignRight.art-text pre {
  padding: 0;
  width: auto;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
/* font-family isn't space-separated, but =~ will have to do */
svg[font-family~="monospace" i], svg [font-family~="monospace" i] {
  font-family: var(--font-mono);
}
.alignCenter.art-text {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  padding: 0.5em 1em 0;
  margin-bottom: 0.5em;
}
.alignCenter.art-text pre {
  padding: 0;
  width: auto;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 0.5em 2em;
  & :is(ol, ul) {
    margin-left: 1em;
  }
}
li {
  margin: 0 0 0.25em 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
  & li {
    margin-top: 0.5em;
  }
}
:is(ul, ol).compact, .ulCompact, .olCompact {
  margin: 0 0 0 2em;
  & li {
    margin: 0;
    & :first-child { margin-top: 0; }
    & :last-child { margin-bottom: 0; }
  }
}

/* definition lists */
dl {
  clear: left;
  --indent: 3ch;
  /* --indent: attr(indent ch); not supported in any browser, but we can dream */
  &.olPercent {
    --indent: 5ch;
    & > dt {
      min-width: calc(var(--indent) - 2ch);
    }
  }
  &.olPercent > dt {
    float: none;
  }

  dl > dd > & {
    margin-top: 0.5em;
    margin-bottom: 0;
  }
}
dl:not(.dlNewline) > dt {
  float: left;
  margin-right: 2ch;
  min-width: 8ch;
}
dl > dd {
  margin-bottom: .8em;
  margin-left: var(--indent) !important; /* stupid element overrides */
  min-height: 2ex;
}
:is(dl.compact, .dlCompact) > dd {
  margin-bottom: 0;
  & > :is(:first-child, .break:first-child + *) {
    margin-top: 0;
  }
  & > :is(:last-child) {
    margin-bottom: 0;
  }
}
:is(dd, span).break {
  display: none;
}

/* links */
a, a[href].selfRef:hover {
  text-decoration: none;
}
a[href] {
  color: var(--link-color);
}
a[href].selfRef, .iref + a[href].internal {
  color: var(--text-color);
}
a[href]:hover {
  text-decoration: underline;
}
a[href].selfRef:hover {
  background-color: var(--highlight-color);
}
a.xref:is(.cite, .auto), :is(#status-of-memo, #copyright) a {
  white-space: nowrap;
}

/* Figures */
tt, code, pre {
  background-color: var(--highlight-color);
  font: 14px/22px var(--font-mono);
}
tt, code {
  /* changing the font for inline elements leads to different ascender
     and descender heights; as we want to retain baseline alignment,
     remove leading to avoid altering the final height of lines
     note: this fails if these blocks take an entire line,
     a different solution would be great */
  line-height: 0;
}
:is(h1, h2, h3, h4, h5, h6) :is(tt, code) {
  font-size: 84%;
}
pre {
  border: 1px solid var(--line-color);
  font-size: 13.5px;
  line-height: 16px;
  letter-spacing: -0.2px;
  margin: 5px;
  padding: 5px;
}
img {
  max-width: 100%;
}
figure {
  margin: 0.5em 0;
  padding: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption, caption {
  font-style: italic;
  margin: 0.5em 1.5em;
  text-align: left;
  caption-side: bottom;
}
@media screen {
  /* Auto-collapse boilerplate. */
  :is(#status-of-memo, #copyright) p {
    margin: -2px 0;
    max-height: 0;
    transition: max-height 2s ease, margin 0.5s ease 0.5s;
    overflow: hidden;
  }
  :is(#status-of-memo, #copyright):hover p,
  :is(#status-of-memo, #copyright) h2:target ~ p {
    margin: 0.5em 0;
    max-height: 500px;
    overflow: auto;
  }
  pre, svg {
    display: inline-block;
    /* In the horizontal direction, sometimes people make over-sized figures.
       Scrollbars for those is therefore necessary: auto adds them as necessary..
       In the vertical direction, the line-height can combine with the font
       asender/descender height to produce scrollbars: hidden avoids that. */
    overflow: auto hidden;
  }
  pre {
    max-width: 100%;
    width: calc(100% - 22px - 1em);
  }
  svg {
    max-width: calc(100% - 22px - 1em);
  }
  figure pre {
    display: block;
    width: calc(100% - 25px);
  }
  :is(pre, svg) + .pilcrow {
    display: inline-block;
    vertical-align: text-bottom;
    padding-bottom: 8px;
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 0 2em;
  font-style: italic;
}
blockquote {
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  width: auto;
  max-width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
}
table.right {
  margin-left: auto;
}
table.center {
  margin-left: auto;
  margin-right: auto;
}
table.left {
  margin-right: auto;
}
table .text-left {
  text-align: left;
}
table .text-center {
  text-align: center;
}
table .text-right {
  text-align: right;
}

thead, tbody {
  border: 1px solid var(--line-color);
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 5px 10px;
}
th {
  background-color: var(--line-color);
}
:is(tr:nth-child(2n), thead+tbody > tr:nth-child(2n+1)) > td {
  background-color: var(--background-color);
}
:is(tr:nth-child(2n+1), thead+tbody > tr:nth-child(2n)) > td {
  background-color: var(--highlight-color);
}
table caption {
  margin: 0;
  padding: 3px 0 3px 1em;
}
table p {
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  margin-left: 3px;
  opacity: 0.2;
  user-select: none;
  &[href] {
    color: var(--pilcrow-weak);
    &:hover { text-decoration: none; }
  }
}
@media not print {
  :hover > a.pilcrow {
    opacity: 1;
  }
  a.pilcrow[href]:hover {
    color: var(--pilcrow-strong);
    background-color: transparent;
  }
}
@media print {
  a.pilcrow {
    display: none;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid var(--line-color);
}
.bcp14 {
  font-variant: small-caps;
  font-weight: 600;
  font-size: var(--small-font-size);
}
.role {
  font-variant: all-small-caps;
}
sub, sup {
  line-height: 1;
  font-size: 80%;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: var(--small-font-size);
  line-height: 18px;
  --identifier-width: 15ch;
  & dt {
    width: var(--identifier-width);
    min-width: var(--identifier-width);
    clear: left;
    float: left;
    text-align: right;
    margin-right: 1ch;
  }
  & dd {
    margin: 0;
    margin-left: calc(1em + var(--identifier-width)) !important;
    min-width: 5em;
  }
  & .authors {
    & .author {
      display: inline-block;
      margin-right: 1.5em;
    }
    & .org {
      font-style: italic;
    }
  }
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #999;
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;

  & nav {
    & ul {
      margin: 0 0.5em 0 0;
      padding: 0;
      list-style: none;
    }
    & li {
      line-height: 1.3em;
      margin: 2px 0;
      padding-left: 1.2em;
      text-indent: -1.2em;
    }
  }
  & a.xref {
    white-space: normal;
  }
}

.references {
  & > dt {
    text-align: right;
    font-weight: bold;
    min-width: 10ch;
    margin-right: 1.5ch;
    &:target::before {
      content: "⇒";
      margin: 0 10px 0 -25px;
    }
  }
  & > dd {
    margin-left: 12ch !important;
    overflow: visible;
    & .refInstance {
      margin-bottom: 0.8em;
    }
    & .ascii {
      margin-bottom: 0.25em;
    }
  }
}

#rfc\.index\.index + ul {
  margin-left: 0;
}

/* authors */
address.vcard {
  font-style: normal;
  max-width: 20em;
  margin: 1em auto 1em 0;

  & .nameRole {
    font-weight: 700;
    margin-left: 0;
  }
  & .label {
    margin: 0.5em 0;
  }
  & .type {
    display: none;
  }
  & .alternative-contact {
    margin: 0.5em 0 0.25em 0;
  }
  & .non-ascii {
    margin: 0 0 0 2em;
  }
  & div.left {
    text-align: left;
  }
  & div.right {
    text-align: right;
  }
}

hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}
@media (min-width: 500px) {
  #authors-addresses > section {
    column-count: 2;
    column-gap: 20px;
  }
  #authors-addresses > section > h2 {
    column-span: all;
  }
  /* hack for break-inside: avoid-column */
  #authors-addresses address {
    display: inline-block;
    break-inside: avoid-column;
  }
}

/* Comments */
.rfcEditorRemove p:first-of-type {
  font-style: italic;
}
.cref {
  background-color: rgba(249, 232, 105, 0.3);
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}

@media screen {
  #toc nav {
    font-family: var(--font-title);
    font-weight: 360;
    & > ul { margin-bottom: 2em; }
    & ul {
      margin: 0 0 0 4px;
      & :is(p, li) {
        margin: 2px 0;
      }
    }
  }
  #toc a.toplink {
    float: right;
  }
}
@media not screen {
  #toc a.toplink {
    display: none;
  }
}


/* TOC layout for smaller screens */
@media screen and (max-width: 929px) {
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 1px 0 0 0;
    margin: 0;
    border-bottom: 1px solid #ccc;
    opacity: 0.6;
  }
  #toc h2 {
    margin: 0;
    padding: 2px 0 2px 6px;
    padding-right: 1em;
    font-size: 18px;
    line-height: 24px;
    min-width: 190px;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
    &::before { /* css hamburger */
      float: right;
      position: relative;
      width: 1em;
      height: 1px;
      left: -164px;
      margin: 8px 0 0 0;
      background: white none repeat scroll 0 0;
      box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
      content: "";
    }
  }
  #toc nav {
    display: none;
    background-color: var(--background-color);
    padding: 0.5em 1em 1em;
    overflow: auto;
    overscroll-behavior: contain;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
  #toc.active {
    opacity: 1;
    & nav { display: block; }
  }
  /* Make the collapsed ToC header render white on gray also when it's a link */
  #toc h2 a,
  #toc h2 a:is(:link, :focus, :hover),
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
  #toc a.toplink {
    margin: 2px 0.5em 0;
  }
}

/* TOC layout for wide screens */
@media screen and (min-width: 930px) {
  body {
    padding-right: 360px;
    padding-right: calc(min(180px + 20%, 500px));
  }
  #toc {
    position: fixed;
    bottom: 0;
    right: 0;
    right: calc(50vw - 480px);
    width: 312px;
    margin: 0;
    padding: 0;
    z-index: 1;
  }
  #toc h2 {
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 2em;
    overflow: auto;
    overscroll-behavior: contain;
    scrollbar-width: thin;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
  #toc a.toplink {
    margin: 8px 0.5em 0;
  }
}

/* pagination */
@media print {
  body {
    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre, .vcard {
    page-break-inside: avoid;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  :is(h2, h3, h4, h5, h6)+*, dd {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
}

/* Dark mode. */
@media (prefers-color-scheme: dark) {
:root {
  --background-color: #121212;
  --text-color: #f0f0f0;
  --title-color: #fff;
  --link-color: #4da4f0;
  --highlight-color: #282828;
  --line-color: #444;
  --pilcrow-weak: #444;
  --pilcrow-strong: #666;
  scrollbar-color: #777 #333;
}
}

/* SVG Trick: a prefix match works because only black and white are allowed */
svg :is([stroke="black"], [stroke^="#000"]) {
  stroke: var(--text-color);
}
svg :is([stroke="white"], [stroke^="#fff"]) {
  stroke: var(--background-color);
}
svg :is([fill="black"], [fill^="#000"], :not([fill])) {
  fill: var(--text-color);
}
svg :is([fill="white"], [fill^="#fff"]) {
  fill: var(--background-color);
}
</style>

</head>
<body class="xml2rfc">
<table class="ears">
<thead><tr>
<td class="left">Internet-Draft</td>
<td class="center">RADIUS over (D)TLS</td>
<td class="right">February 2025</td>
</tr></thead>
<tfoot><tr>
<td class="left">Rieckers &amp; Winter</td>
<td class="center">Expires 25 August 2025</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-workgroup">Workgroup:</dt>
<dd class="workgroup">RADIUS EXTensions</dd>
<dt class="label-internet-draft">Internet-Draft:</dt>
<dd class="internet-draft">draft-ietf-radext-radiusdtls-bis-latest</dd>
<dt class="label-obsoletes">Obsoletes:</dt>
<dd class="obsoletes">
<a href="https://www.rfc-editor.org/rfc/rfc6614" class="eref">6614</a>, <a href="https://www.rfc-editor.org/rfc/rfc7360" class="eref">7360</a> (if approved)</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2025-02-21" class="published">21 February 2025</time>
    </dd>
<dt class="label-intended-status">Intended Status:</dt>
<dd class="intended-status">Standards Track</dd>
<dt class="label-expires">Expires:</dt>
<dd class="expires"><time datetime="2025-08-25">25 August 2025</time></dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">J.-F. Rieckers</div>
<div class="org">DFN</div>
</div>
<div class="author">
      <div class="author-name">S. Winter</div>
<div class="org">RESTENA</div>
</div>
</dd>
</dl>
</div>
<h1 id="title">(Datagram) Transport Layer Security ((D)TLS Encryption for RADIUS</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">This document specifies a transport profile for RADIUS using Transport Layer Security (TLS) over TCP or Datagram Transport Layer Security (DTLS) over UDP as the transport protocol.
This enables encrypting the RADIUS traffic as well as dynamic trust relationships between RADIUS servers.
The specification obsoletes the experimental specifications in RFC 6614 (RADIUS/TLS) and RFC 7360 (RADIUS/DTLS) and combines them in this specification.<a href="#section-abstract-1" class="pilcrow">¶</a></p>
</section>
<section class="note rfcEditorRemove" id="section-note.1">
      <h2 id="name-about-this-document">
<a href="#name-about-this-document" class="section-name selfRef">About This Document</a>
      </h2>
<p id="section-note.1-1">This note is to be removed before publishing as an RFC.<a href="#section-note.1-1" class="pilcrow">¶</a></p>
<p id="section-note.1-2">
        Status information for this document may be found at <span><a href="https://datatracker.ietf.org/doc/draft-ietf-radext-radiusdtls-bis/">https://datatracker.ietf.org/doc/draft-ietf-radext-radiusdtls-bis/</a></span>.<a href="#section-note.1-2" class="pilcrow">¶</a></p>
<p id="section-note.1-3">
        Discussion of this document takes place on the
        RADIUS EXTensions Working Group mailing list (<span><a href="mailto:radext@ietf.org">mailto:radext@ietf.org</a></span>),
        which is archived at <span><a href="https://mailarchive.ietf.org/arch/browse/radext/">https://mailarchive.ietf.org/arch/browse/radext/</a></span>.
        Subscribe at <span><a href="https://www.ietf.org/mailman/listinfo/radext/">https://www.ietf.org/mailman/listinfo/radext/</a></span>.<a href="#section-note.1-3" class="pilcrow">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a href="#name-status-of-this-memo" class="section-name selfRef">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
        This Internet-Draft is submitted in full conformance with the
        provisions of BCP 78 and BCP 79.<a href="#section-boilerplate.1-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-2">
        Internet-Drafts are working documents of the Internet Engineering Task
        Force (IETF). Note that other groups may also distribute working
        documents as Internet-Drafts. The list of current Internet-Drafts is
        at <span><a href="https://datatracker.ietf.org/drafts/current/">https://datatracker.ietf.org/drafts/current/</a></span>.<a href="#section-boilerplate.1-2" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-3">
        Internet-Drafts are draft documents valid for a maximum of six months
        and may be updated, replaced, or obsoleted by other documents at any
        time. It is inappropriate to use Internet-Drafts as reference
        material or to cite them other than as "work in progress."<a href="#section-boilerplate.1-3" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-4">
        This Internet-Draft will expire on 25 August 2025.<a href="#section-boilerplate.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a href="#name-copyright-notice" class="section-name selfRef">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2025 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a href="#section-boilerplate.2-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Revised BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Revised BSD License.<a href="#section-boilerplate.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">▲</a><h2 id="name-table-of-contents">
<a href="#name-table-of-contents" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1" class="keepWithNext"><a href="#section-1" class="auto internal xref">1</a>.  <a href="#name-introduction" class="internal xref">Introduction</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.1">
                <p id="section-toc.1-1.1.2.1.1" class="keepWithNext"><a href="#section-1.1" class="auto internal xref">1.1</a>.  <a href="#name-purpose-of-radius-dtls" class="internal xref">Purpose of RADIUS/(D)TLS</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.2">
                <p id="section-toc.1-1.1.2.2.1" class="keepWithNext"><a href="#section-1.2" class="auto internal xref">1.2</a>.  <a href="#name-changes-from-rfc6614-radius" class="internal xref">Changes from RFC6614 (RADIUS/TLS) and RFC7360 (RADIUS/DTLS)</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1"><a href="#section-2" class="auto internal xref">2</a>.  <a href="#name-conventions-and-definitions" class="internal xref">Conventions and Definitions</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a href="#section-3" class="auto internal xref">3</a>.  <a href="#name-changes-to-radius" class="internal xref">Changes to RADIUS</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.1">
                <p id="section-toc.1-1.3.2.1.1"><a href="#section-3.1" class="auto internal xref">3.1</a>.  <a href="#name-packet-format" class="internal xref">Packet format</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2">
                <p id="section-toc.1-1.3.2.2.1"><a href="#section-3.2" class="auto internal xref">3.2</a>.  <a href="#name-default-ports-and-shared-se" class="internal xref">Default ports and shared secrets</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.3">
                <p id="section-toc.1-1.3.2.3.1"><a href="#section-3.3" class="auto internal xref">3.3</a>.  <a href="#name-detecting-live-servers" class="internal xref">Detecting Live Servers</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="auto internal xref">4</a>.  <a href="#name-packet-connection-handling" class="internal xref">Packet / Connection Handling</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.1">
                <p id="section-toc.1-1.4.2.1.1"><a href="#section-4.1" class="auto internal xref">4.1</a>.  <a href="#name-dtls-requirements" class="internal xref">(D)TLS requirements</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2">
                <p id="section-toc.1-1.4.2.2.1"><a href="#section-4.2" class="auto internal xref">4.2</a>.  <a href="#name-mutual-authentication" class="internal xref">Mutual authentication</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2.2.1">
                    <p id="section-toc.1-1.4.2.2.2.1.1"><a href="#section-4.2.1" class="auto internal xref">4.2.1</a>.  <a href="#name-authentication-using-x509-c" class="internal xref">Authentication using X.509 certificates with PKIX trust model (TLS-X.509-PKIX)</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2.2.2">
                    <p id="section-toc.1-1.4.2.2.2.2.1"><a href="#section-4.2.2" class="auto internal xref">4.2.2</a>.  <a href="#name-authentication-using-x509-ce" class="internal xref">Authentication using X.509 certificate fingerprints (TLS-X.509-FINGERPRINT)</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2.2.3">
                    <p id="section-toc.1-1.4.2.2.2.3.1"><a href="#section-4.2.3" class="auto internal xref">4.2.3</a>.  <a href="#name-authentication-using-raw-pu" class="internal xref">Authentication using Raw Public Keys (TLS-RAW-PUBLIC-KEYS)</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2.2.4">
                    <p id="section-toc.1-1.4.2.2.2.4.1"><a href="#section-4.2.4" class="auto internal xref">4.2.4</a>.  <a href="#name-authentication-using-tls-ps" class="internal xref">Authentication using TLS-PSK (TLS-PSK)</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.3">
                <p id="section-toc.1-1.4.2.3.1"><a href="#section-4.3" class="auto internal xref">4.3</a>.  <a href="#name-connecting-client-identity" class="internal xref">Connecting Client Identity</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.4">
                <p id="section-toc.1-1.4.2.4.1"><a href="#section-4.4" class="auto internal xref">4.4</a>.  <a href="#name-radius-datagrams" class="internal xref">RADIUS Datagrams</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.5">
                <p id="section-toc.1-1.4.2.5.1"><a href="#section-4.5" class="auto internal xref">4.5</a>.  <a href="#name-forwarding-radius-packets-b" class="internal xref">Forwarding RADIUS packets between UDP and TCP based transports</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.5.2.1">
                    <p id="section-toc.1-1.4.2.5.2.1.1"><a href="#section-4.5.1" class="auto internal xref">4.5.1</a>.  <a href="#name-throughput-differences-lead" class="internal xref">Throughput Differences lead to Network Collapse</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.5.2.2">
                    <p id="section-toc.1-1.4.2.5.2.2.1"><a href="#section-4.5.2" class="auto internal xref">4.5.2</a>.  <a href="#name-differing-retransmission-re" class="internal xref">Differing Retransmission Requirements</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.6">
                <p id="section-toc.1-1.4.2.6.1"><a href="#section-4.6" class="auto internal xref">4.6</a>.  <a href="#name-session-limits-and-timeout" class="internal xref">Session limits and timeout</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.7">
                <p id="section-toc.1-1.4.2.7.1"><a href="#section-4.7" class="auto internal xref">4.7</a>.  <a href="#name-malformed-packets-and-unkno" class="internal xref">Malformed Packets and Unknown clients</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="auto internal xref">5</a>.  <a href="#name-radius-tls-specific-specifi" class="internal xref">RADIUS/TLS specific specifications</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1">
                <p id="section-toc.1-1.5.2.1.1"><a href="#section-5.1" class="auto internal xref">5.1</a>.  <a href="#name-duplicates-and-retransmissi" class="internal xref">Duplicates and Retransmissions</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2">
                <p id="section-toc.1-1.5.2.2.1"><a href="#section-5.2" class="auto internal xref">5.2</a>.  <a href="#name-tcp-applications-are-not-ud" class="internal xref">TCP Applications Are Not UDP Applications</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#section-6" class="auto internal xref">6</a>.  <a href="#name-radius-dtls-specific-specif" class="internal xref">RADIUS/DTLS specific specifications</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.1">
                <p id="section-toc.1-1.6.2.1.1"><a href="#section-6.1" class="auto internal xref">6.1</a>.  <a href="#name-radius-packet-lengths" class="internal xref">RADIUS packet lengths</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.2">
                <p id="section-toc.1-1.6.2.2.1"><a href="#section-6.2" class="auto internal xref">6.2</a>.  <a href="#name-server-behavior" class="internal xref">Server behavior</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.3">
                <p id="section-toc.1-1.6.2.3.1"><a href="#section-6.3" class="auto internal xref">6.3</a>.  <a href="#name-client-behavior" class="internal xref">Client behavior</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.4">
                <p id="section-toc.1-1.6.2.4.1"><a href="#section-6.4" class="auto internal xref">6.4</a>.  <a href="#name-session-management" class="internal xref">Session Management</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.4.2.1">
                    <p id="section-toc.1-1.6.2.4.2.1.1"><a href="#section-6.4.1" class="auto internal xref">6.4.1</a>.  <a href="#name-server-session-management" class="internal xref">Server Session Management</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.4.2.2">
                    <p id="section-toc.1-1.6.2.4.2.2.1"><a href="#section-6.4.2" class="auto internal xref">6.4.2</a>.  <a href="#name-client-session-management" class="internal xref">Client Session Management</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#section-7" class="auto internal xref">7</a>.  <a href="#name-security-considerations" class="internal xref">Security Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.1">
                <p id="section-toc.1-1.7.2.1.1"><a href="#section-7.1" class="auto internal xref">7.1</a>.  <a href="#name-radius-proxies" class="internal xref">RADIUS Proxies</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.2">
                <p id="section-toc.1-1.7.2.2.1"><a href="#section-7.2" class="auto internal xref">7.2</a>.  <a href="#name-usage-of-null-encryption-ci" class="internal xref">Usage of null encryption cipher suites for debugging</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.3">
                <p id="section-toc.1-1.7.2.3.1"><a href="#section-7.3" class="auto internal xref">7.3</a>.  <a href="#name-possibility-of-denial-of-se" class="internal xref">Possibility of Denial-of-Service attacks</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.4">
                <p id="section-toc.1-1.7.2.4.1"><a href="#section-7.4" class="auto internal xref">7.4</a>.  <a href="#name-session-closing" class="internal xref">Session Closing</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.5">
                <p id="section-toc.1-1.7.2.5.1"><a href="#section-7.5" class="auto internal xref">7.5</a>.  <a href="#name-migrating-from-radius-udp-t" class="internal xref">Migrating from RADIUS/UDP to RADIUS/(D)TLS</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.6">
                <p id="section-toc.1-1.7.2.6.1"><a href="#section-7.6" class="auto internal xref">7.6</a>.  <a href="#name-client-subsystems" class="internal xref">Client Subsystems</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.7">
                <p id="section-toc.1-1.7.2.7.1"><a href="#section-7.7" class="auto internal xref">7.7</a>.  <a href="#name-loopback-attack-on-peers-ac" class="internal xref">Loopback-Attack on Peers acting as Server and Client</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#section-8" class="auto internal xref">8</a>.  <a href="#name-design-decisions" class="internal xref">Design Decisions</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.1">
                <p id="section-toc.1-1.8.2.1.1"><a href="#section-8.1" class="auto internal xref">8.1</a>.  <a href="#name-mandatory-to-implement-tran" class="internal xref">Mandatory-to-implement transports</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.2">
                <p id="section-toc.1-1.8.2.2.1"><a href="#section-8.2" class="auto internal xref">8.2</a>.  <a href="#name-mandatory-to-implement-trus" class="internal xref">Mandatory-to-implement trust profiles</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.3">
                <p id="section-toc.1-1.8.2.3.1"><a href="#section-8.3" class="auto internal xref">8.3</a>.  <a href="#name-changes-in-application-of-t" class="internal xref">Changes in application of TLS</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a href="#section-9" class="auto internal xref">9</a>.  <a href="#name-iana-considerations" class="internal xref">IANA Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a href="#section-10" class="auto internal xref">10</a>. <a href="#name-references" class="internal xref">References</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.1">
                <p id="section-toc.1-1.10.2.1.1"><a href="#section-10.1" class="auto internal xref">10.1</a>.  <a href="#name-normative-references" class="internal xref">Normative References</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.2">
                <p id="section-toc.1-1.10.2.2.1"><a href="#section-10.2" class="auto internal xref">10.2</a>.  <a href="#name-informative-references" class="internal xref">Informative References</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11">
            <p id="section-toc.1-1.11.1"><a href="#appendix-A" class="auto internal xref">Appendix A</a>.  <a href="#name-lessons-learned-from-deploy" class="internal xref">Lessons learned from deployments of the Experimental RFC6614</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.1">
                <p id="section-toc.1-1.11.2.1.1"><a href="#appendix-A.1" class="auto internal xref">A.1</a>.  <a href="#name-eduroam" class="internal xref">eduroam</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.2">
                <p id="section-toc.1-1.11.2.2.1"><a href="#appendix-A.2" class="auto internal xref">A.2</a>.  <a href="#name-wireless-broadband-alliance" class="internal xref">Wireless Broadband Alliance's OpenRoaming</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.3">
                <p id="section-toc.1-1.11.2.3.1"><a href="#appendix-A.3" class="auto internal xref">A.3</a>.  <a href="#name-participating-in-more-than-" class="internal xref">Participating in more than one roaming consortium</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12">
            <p id="section-toc.1-1.12.1"><a href="#appendix-B" class="auto internal xref">Appendix B</a>.  <a href="#name-interoperable-implementatio" class="internal xref">Interoperable Implementations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13">
            <p id="section-toc.1-1.13.1"><a href="#appendix-C" class="auto internal xref">Appendix C</a>.  <a href="#name-backward-compatibility" class="internal xref">Backward compatibility</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14">
            <p id="section-toc.1-1.14.1"><a href="#appendix-D" class="auto internal xref"></a><a href="#name-acknowledgments" class="internal xref">Acknowledgments</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15">
            <p id="section-toc.1-1.15.1"><a href="#appendix-E" class="auto internal xref"></a><a href="#name-authors-addresses" class="internal xref">Authors' Addresses</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="introduction">
<section id="section-1">
      <h2 id="name-introduction">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-introduction" class="section-name selfRef">Introduction</a>
      </h2>
<p id="section-1-1">The RADIUS protocol is a widely deployed authentication, authorization and accounting solution.
It is defined in <span>[<a href="#RFC2865" class="cite xref">RFC2865</a>]</span>, <span>[<a href="#RFC2866" class="cite xref">RFC2866</a>]</span>, <span>[<a href="#RFC5176" class="cite xref">RFC5176</a>]</span> and others.
The deployment experience has shown several shortcomings, such as its dependency on the unreliable transport protocol UDP and the lack of confidentiality for large parts of its packet payload.
Additionally the confidentiality and integrity mechanisms rely on the MD5 algorithm, which has been proven to be insecure.
Although RADIUS/(D)TLS does not remove the MD5-based mechanisms, it adds confidentiality and integrity protection through the TLS layer.
For an updated version of RADIUS/(D)TLS without need for MD5 see <span>[<a href="#I-D.ietf-radext-radiusv11" class="cite xref">I-D.ietf-radext-radiusv11</a>]</span><a href="#section-1-1" class="pilcrow">¶</a></p>
<div id="purpose-of-radiusdtls">
<section id="section-1.1">
        <h3 id="name-purpose-of-radius-dtls">
<a href="#section-1.1" class="section-number selfRef">1.1. </a><a href="#name-purpose-of-radius-dtls" class="section-name selfRef">Purpose of RADIUS/(D)TLS</a>
        </h3>
<p id="section-1.1-1">The main focus of RADIUS/TLS and RADIUS/DTLS is to provide means to secure communication between RADIUS peers using TLS or DTLS.
The most important use of this specification lies in roaming environments where RADIUS packets need to be sent across insecure or untrusted networks.
An example for a worldwide roaming environment that uses RADIUS over TLS to secure communication is eduroam as described in <span>[<a href="#RFC7593" class="cite xref">RFC7593</a>]</span><a href="#section-1.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="changes-from-rfc6614-radiustls-and-rfc7360-radiusdtls">
<section id="section-1.2">
        <h3 id="name-changes-from-rfc6614-radius">
<a href="#section-1.2" class="section-number selfRef">1.2. </a><a href="#name-changes-from-rfc6614-radius" class="section-name selfRef">Changes from RFC6614 (RADIUS/TLS) and RFC7360 (RADIUS/DTLS)</a>
        </h3>
<ul class="normal">
<li class="normal" id="section-1.2-1.1">
            <p id="section-1.2-1.1.1"><span>[<a href="#RFC6614" class="cite xref">RFC6614</a>]</span> referenced <span>[<a href="#RFC6613" class="cite xref">RFC6613</a>]</span> for TCP-related specification, RFC6613 on the other hand had some specification for RADIUS/TLS.
These specifications have been merged into this document.<a href="#section-1.2-1.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-1.2-1.2">
            <p id="section-1.2-1.2.1">RFC6614 marked TLSv1.1 or later as mandatory, this specification requires TLSv1.2 as minimum and recommends usage of TLSv1.3.<a href="#section-1.2-1.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-1.2-1.3">
            <p id="section-1.2-1.3.1">RFC6614 allowed usage of TLS compression, this document forbids it.<a href="#section-1.2-1.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-1.2-1.4">
            <p id="section-1.2-1.4.1">RFC6614 only requires support for the trust model "certificates with PKIX" (<span>[<a href="#RFC6614" class="cite xref">RFC6614</a>], <a href="https://rfc-editor.org/rfc/rfc6614#section-2.3" class="relref">Section 2.3</a></span>). This document changes this. For servers, TLS-X.509-PKIX (<a href="#tlsx509pkix" class="auto internal xref">Section 4.2.1</a>, equivalent to "certificates with PKIX" in RFC6614) and TLS-PSK (<a href="#tlspsk" class="auto internal xref">Section 4.2.4</a>) is now mandated and clients must implement at least one of the two.<a href="#section-1.2-1.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-1.2-1.5">
            <p id="section-1.2-1.5.1">The mandatory-to-implement cipher suites are not referenced directly, this is replaced by a pointer to the TLS BCP.<a href="#section-1.2-1.5.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-1.2-1.6">
            <p id="section-1.2-1.6.1">The specification regarding steps for certificate verification has been updated.<a href="#section-1.2-1.6.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-1.2-1.7">
            <p id="section-1.2-1.7.1"><span>[<a href="#RFC6613" class="cite xref">RFC6613</a>]</span> mandated the use of Status-Server as watchdog algorithm, <span>[<a href="#RFC7360" class="cite xref">RFC7360</a>]</span> only recommended it. This specification mandates the use of Status-Server for both RADIUS/TLS and RADIUS/DTLS.<a href="#section-1.2-1.7.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-1.2-1.8">
            <p id="section-1.2-1.8.1"><span>[<a href="#RFC6613" class="cite xref">RFC6613</a>]</span> only included limited text around retransmissions, this document now gives more guidance on how to handle retransmissions, especially across different transports.<a href="#section-1.2-1.8.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-1.2-1.9">
            <p id="section-1.2-1.9.1">The rules for verifying the peer certificate have been updated to follow guidance provided in <span>[<a href="#RFC9525" class="cite xref">RFC9525</a>]</span>. Using the Common Name RDN for validation is now forbidden.<a href="#section-1.2-1.9.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-1.2-2">The rationales behind some of these changes are outlined in <a href="#design_decisions" class="auto internal xref">Section 8</a>.<a href="#section-1.2-2" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="conventions-and-definitions">
<section id="section-2">
      <h2 id="name-conventions-and-definitions">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-conventions-and-definitions" class="section-name selfRef">Conventions and Definitions</a>
      </h2>
<p id="section-2-1">The key words "<span class="bcp14">MUST</span>", "<span class="bcp14">MUST NOT</span>", "<span class="bcp14">REQUIRED</span>", "<span class="bcp14">SHALL</span>", "<span class="bcp14">SHALL NOT</span>", "<span class="bcp14">SHOULD</span>", "<span class="bcp14">SHOULD NOT</span>", "<span class="bcp14">RECOMMENDED</span>", "<span class="bcp14">NOT RECOMMENDED</span>",
"<span class="bcp14">MAY</span>", and "<span class="bcp14">OPTIONAL</span>" in this document are to be interpreted as
described in BCP 14 <span>[<a href="#RFC2119" class="cite xref">RFC2119</a>]</span> <span>[<a href="#RFC8174" class="cite xref">RFC8174</a>]</span> when, and only when, they
appear in all capitals, as shown here.<a href="#section-2-1" class="pilcrow">¶</a></p>
<p id="section-2-2">Within this document we will use the following terms:<a href="#section-2-2" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-2-3">
        <dt id="section-2-3.1">RADIUS/(D)TLS node:</dt>
        <dd style="margin-left: 1.5em" id="section-2-3.2">
          <p id="section-2-3.2.1">a RADIUS-over-(D)TLS client or server<a href="#section-2-3.2.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
<dt id="section-2-3.3">RADIUS/(D)TLS client:</dt>
        <dd style="margin-left: 1.5em" id="section-2-3.4">
          <p id="section-2-3.4.1">a RADIUS-over-(D)TLS instance that initiates a new connection<a href="#section-2-3.4.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
<dt id="section-2-3.5">RADIUS/(D)TLS server:</dt>
        <dd style="margin-left: 1.5em" id="section-2-3.6">
          <p id="section-2-3.6.1">a RADIUS-over-(D)TLS instance that listens on a RADIUS-over-(D)TLS port and accepts new connections<a href="#section-2-3.6.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
<dt id="section-2-3.7">RADIUS/UDP:</dt>
        <dd style="margin-left: 1.5em" id="section-2-3.8">
          <p id="section-2-3.8.1">a classic RADIUS transport over UDP as defined in <span>[<a href="#RFC2865" class="cite xref">RFC2865</a>]</span><a href="#section-2-3.8.1" class="pilcrow">¶</a></p>
</dd>
      <dd class="break"></dd>
</dl>
<p id="section-2-4">Whenever "(D)TLS" or "RADIUS/(D)TLS" is mentioned, the specification applies for both RADIUS/TLS and RADIUS/DTLS.
Where "TLS" or "RADIUS/TLS" is mentioned, the specification only applies to RADIUS/TLS, where "DTLS" or "RADIUS/DTLS" is mentioned it only applies to RADIUS/DTLS.<a href="#section-2-4" class="pilcrow">¶</a></p>
<p id="section-2-5">Server implementations <span class="bcp14">MUST</span> support both RADIUS/TLS and RADIUS/DTLS.
Client implementations <span class="bcp14">SHOULD</span> implement both, but <span class="bcp14">MUST</span> implement at least one of RADIUS/TLS or RADIUS/DTLS.<a href="#section-2-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="changes-to-radius">
<section id="section-3">
      <h2 id="name-changes-to-radius">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-changes-to-radius" class="section-name selfRef">Changes to RADIUS</a>
      </h2>
<p id="section-3-1">This section discusses the needed changes to the RADIUS packet format (<a href="#pktformat" class="auto internal xref">Section 3.1</a>), port usage and shared secrets (<a href="#portusage" class="auto internal xref">Section 3.2</a>).<a href="#section-3-1" class="pilcrow">¶</a></p>
<div id="pktformat">
<section id="section-3.1">
        <h3 id="name-packet-format">
<a href="#section-3.1" class="section-number selfRef">3.1. </a><a href="#name-packet-format" class="section-name selfRef">Packet format</a>
        </h3>
<p id="section-3.1-1">The RADIUS packet format is unchanged from <span>[<a href="#RFC2865" class="cite xref">RFC2865</a>]</span>, <span>[<a href="#RFC2866" class="cite xref">RFC2866</a>]</span> and <span>[<a href="#RFC5176" class="cite xref">RFC5176</a>]</span>.
Specifically, all of the following portions of RADIUS <span class="bcp14">MUST</span> be unchanged when using RADIUS/(D)TLS:<a href="#section-3.1-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.1-2.1">
            <p id="section-3.1-2.1.1">Packet format<a href="#section-3.1-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.1-2.2">
            <p id="section-3.1-2.2.1">Permitted codes<a href="#section-3.1-2.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.1-2.3">
            <p id="section-3.1-2.3.1">Request Authenticator calculation<a href="#section-3.1-2.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.1-2.4">
            <p id="section-3.1-2.4.1">Response Authenticator calculation<a href="#section-3.1-2.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.1-2.5">
            <p id="section-3.1-2.5.1">Minimum packet length<a href="#section-3.1-2.5.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.1-2.6">
            <p id="section-3.1-2.6.1">Maximum packet length<a href="#section-3.1-2.6.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.1-2.7">
            <p id="section-3.1-2.7.1">Attribute format<a href="#section-3.1-2.7.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.1-2.8">
            <p id="section-3.1-2.8.1">Vendor-Specific Attribute (VSA) format<a href="#section-3.1-2.8.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.1-2.9">
            <p id="section-3.1-2.9.1">Permitted data types<a href="#section-3.1-2.9.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.1-2.10">
            <p id="section-3.1-2.10.1">Calculation of dynamic attributes such as CHAP-Challenge, or Message-Authenticator<a href="#section-3.1-2.10.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.1-2.11">
            <p id="section-3.1-2.11.1">Calculation of "encrypted" attributes such as Tunnel-Password.<a href="#section-3.1-2.11.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-3.1-3">The use of (D)TLS transport does not change the calculation of security-related fields (such as the Response-Authenticator) in RADIUS <span>[<a href="#RFC2865" class="cite xref">RFC2865</a>]</span> or RADIUS Dynamic Authorization <span>[<a href="#RFC5176" class="cite xref">RFC5176</a>]</span>.
Calculation of attributes such as User-Password <span>[<a href="#RFC2865" class="cite xref">RFC2865</a>]</span> or Message-Authenticator <span>[<a href="#RFC3579" class="cite xref">RFC3579</a>]</span> also does not change.<a href="#section-3.1-3" class="pilcrow">¶</a></p>
<p id="section-3.1-4">The changes to RADIUS implementations required to implement this specification are largely limited to the portions that send and receive packets on the network and the establishment of the (D)TLS connection.<a href="#section-3.1-4" class="pilcrow">¶</a></p>
<p id="section-3.1-5">The requirement that RADIUS remain largely unchanged ensures the simplest possible implementation and widest interoperability of the specification.
This includes the usage of the outdated security mechanisms in RADIUS that are based on shared secrets and MD5.
This is not considered a security issue, since integrity and confidentiality are provided by the (D)TLS layer. See <a href="#security_considerations" class="auto internal xref">Section 7</a> of this document or <span>[<a href="#I-D.ietf-radext-radiusv11" class="cite xref">I-D.ietf-radext-radiusv11</a>]</span> for more details.<a href="#section-3.1-5" class="pilcrow">¶</a></p>
<p id="section-3.1-6">We note that for RADIUS/DTLS the DTLS encapsulation of RADIUS means that RADIUS packets have an additional overhead due to DTLS.
This is discussed further in <a href="#dtls_spec" class="auto internal xref">Section 6</a>.<a href="#section-3.1-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="portusage">
<section id="section-3.2">
        <h3 id="name-default-ports-and-shared-se">
<a href="#section-3.2" class="section-number selfRef">3.2. </a><a href="#name-default-ports-and-shared-se" class="section-name selfRef">Default ports and shared secrets</a>
        </h3>
<p id="section-3.2-1">IANA has reserved ports for RADIUS/TLS and RADIUS/DTLS.
Since authentication of peers, confidentiality, and integrity protection is achieved on the (D)TLS layer, the shared secret for the RADIUS packets is set to a static string, depending on the method.
The calculation of security-related fields such as Response-Authenticator, Message-Authenticator or encrypted attributes <span class="bcp14">MUST</span> be performed using this shared secret.<a href="#section-3.2-1" class="pilcrow">¶</a></p>
<table class="center" id="table-1">
          <caption><a href="#table-1" class="selfRef">Table 1</a></caption>
<thead>
            <tr>
              <th class="text-left" rowspan="1" colspan="1">Protocol</th>
              <th class="text-left" rowspan="1" colspan="1">Port</th>
              <th class="text-left" rowspan="1" colspan="1">Shared Secret</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">RADIUS/TLS</td>
              <td class="text-left" rowspan="1" colspan="1">2083/tcp</td>
              <td class="text-left" rowspan="1" colspan="1">"radsec"</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">RADIUS/DTLS</td>
              <td class="text-left" rowspan="1" colspan="1">2083/udp</td>
              <td class="text-left" rowspan="1" colspan="1">"radius/dtls"</td>
            </tr>
          </tbody>
        </table>
<p id="section-3.2-3">RADIUS/(D)TLS does not use separate ports for authentication, accounting and dynamic authorization changes.
The source port is arbitrary.
For considerations regarding the multi-purpose use of one port for authentication and accounting see <a href="#radius_datagrams" class="auto internal xref">Section 4.4</a>.<a href="#section-3.2-3" class="pilcrow">¶</a></p>
<p id="section-3.2-4">RADIUS/TLS servers <span class="bcp14">MUST</span> immediately start the TLS negotiation when a new connection to the RADIUS/TLS port is opened.
They <span class="bcp14">MUST</span> close the connection and discard any data sent if the connecting client does not start a TLS negotiation or if the TLS negotiation fails at any point.<a href="#section-3.2-4" class="pilcrow">¶</a></p>
<p id="section-3.2-5">RADIUS/DTLS servers <span class="bcp14">MUST</span> silently discard any packet they receive over the RADIUS/DTLS port that is not a new DTLS negotiation or a packet sent over a DTLS session established earlier.<a href="#section-3.2-5" class="pilcrow">¶</a></p>
<p id="section-3.2-6">RADIUS/(D)TLS peers <span class="bcp14">MUST NOT</span> use the old RADIUS/UDP or RADIUS/TCP ports for RADIUS/DTLS or RADIUS/TLS.<a href="#section-3.2-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="detecting-live-servers">
<section id="section-3.3">
        <h3 id="name-detecting-live-servers">
<a href="#section-3.3" class="section-number selfRef">3.3. </a><a href="#name-detecting-live-servers" class="section-name selfRef">Detecting Live Servers</a>
        </h3>
<p id="section-3.3-1">As RADIUS is a "hop-by-hop" protocol, a RADIUS proxy shields the client from any information about downstream servers.
While the client may be able to deduce the operational state of the local server (i.e., proxy), it cannot make any determination about the operational state of the downstream servers.<a href="#section-3.3-1" class="pilcrow">¶</a></p>
<p id="section-3.3-2">Within RADIUS, proxies typically only forward traffic between the NAS and RADIUS servers, and they do not generate their own response.
As a result, when a NAS does not receive a response to a request, this could be the result of packet loss between the NAS and proxy, a problem on the proxy, loss between the RADIUS proxy and server, or a problem with the server.<a href="#section-3.3-2" class="pilcrow">¶</a></p>
<p id="section-3.3-3">The absence of a reply can cause a client to deduce (incorrectly) that the proxy is unavailable.
The client could then fail over to another server or conclude that no "live" servers are available (OKAY state in <span>[<a href="#RFC3539" class="cite xref">RFC3539</a>]</span>, Appendix A).
This situation is made even worse when requests are sent through a proxy to multiple destinations.
Failures in one destination may result in service outages for other destinations, if the client erroneously believes that the proxy is unresponsive.<a href="#section-3.3-3" class="pilcrow">¶</a></p>
<p id="section-3.3-4">RADIUS/(D)TLS implementations <span class="bcp14">MUST</span> utilize the existence of a TCP/DTLS connection along with the application-layer watchdog defined in <span>[<a href="#RFC3539" class="cite xref">RFC3539</a>], <a href="https://rfc-editor.org/rfc/rfc3539#section-3.4" class="relref">Section 3.4</a></span> to determine the liveliness of the server.<a href="#section-3.3-4" class="pilcrow">¶</a></p>
<p id="section-3.3-5">RADIUS/(D)TLS clients <span class="bcp14">MUST</span> mark a connection DOWN if one or more of the following conditions are met:<a href="#section-3.3-5" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.3-6.1">
            <p id="section-3.3-6.1.1">The administrator has marked the connection administrative DOWN.<a href="#section-3.3-6.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.3-6.2">
            <p id="section-3.3-6.2.1">The network stack indicates that the connection is no longer viable.<a href="#section-3.3-6.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.3-6.3">
            <p id="section-3.3-6.3.1">The application-layer watchdog algorithm has marked it DOWN.<a href="#section-3.3-6.3.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-3.3-7">If a RADIUS/(D)TLS client has multiple connection to a server, it <span class="bcp14">MUST NOT</span> decide to mark the whole server as DOWN until all connections to it have been marked DOWN.<span class="cref" id="what_is_a_server_1">TODO: Explain what a server is. (Just the destination IP? include port?)<span class="crefSource">Janfred</span></span><a href="#section-3.3-7" class="pilcrow">¶</a></p>
<p id="section-3.3-8">RADIUS/(D)TLS clients <span class="bcp14">MUST</span> implement the Status-Server extension as described in <span>[<a href="#RFC5997" class="cite xref">RFC5997</a>]</span> as the application level watchdog to detect the liveliness of the peer in the absence of responses.
Since RADIUS has a limitation of 256 simultaneous "in flight" packets due to the length of the ID field (<span>[<a href="#RFC3539" class="cite xref">RFC3539</a>]</span>, Section 2.4), it is <span class="bcp14">RECOMMENDED</span> that RADIUS/(D)TLS clients reserve ID zero (0) on each session for Status-Server packets.
This value was picked arbitrary, as there is no reason to choose any other value over another for this use.<a href="#section-3.3-8" class="pilcrow">¶</a></p>
<p id="section-3.3-9">For RADIUS/TLS, the peers <span class="bcp14">MAY</span> send TCP keepalives as described in <span>[<a href="#RFC9293" class="cite xref">RFC9293</a>], <a href="https://rfc-editor.org/rfc/rfc9293#section-3.8.4" class="relref">Section 3.8.4</a></span>.
For RADIUS/DTLS connections, the peers <span class="bcp14">MAY</span> send periodic keepalives as defined in <span>[<a href="#RFC6520" class="cite xref">RFC6520</a>]</span>.
This is a way of proactively and rapidly triggering a connection DOWN notification from the network stack.
These liveliness checks are essentially redundant in the presence of an application-layer watchdog, but may provide more rapid notifications of connectivity issues.<a href="#section-3.3-9" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="packet-connection-handling">
<section id="section-4">
      <h2 id="name-packet-connection-handling">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-packet-connection-handling" class="section-name selfRef">Packet / Connection Handling</a>
      </h2>
<p id="section-4-1">This section defines the behaviour for RADIUS/(D)TLS peers for handling of incoming packets and establishment of a (D)TLS session.<a href="#section-4-1" class="pilcrow">¶</a></p>
<div id="dtls-requirements">
<section id="section-4.1">
        <h3 id="name-dtls-requirements">
<a href="#section-4.1" class="section-number selfRef">4.1. </a><a href="#name-dtls-requirements" class="section-name selfRef">(D)TLS requirements</a>
        </h3>
<p id="section-4.1-1">As defined in <a href="#portusage" class="auto internal xref">Section 3.2</a>, RADIUS/(D)TLS clients <span class="bcp14">MUST</span> establish a (D)TLS session immediately upon connecting to a new server.<a href="#section-4.1-1" class="pilcrow">¶</a></p>
<p id="section-4.1-2">RADIUS/(D)TLS has no notion of negotiating (D)TLS in an ongoing communication.
As RADIUS has no provisions for capability signaling, there is also no way for a server to indicate to a client that it should transition to using TLS or DTLS.
Servers and clients need to be preconfigured to use RADIUS/(D)TLS for a given endpoint.
This action has to be taken by the administrators of the two systems.<a href="#section-4.1-2" class="pilcrow">¶</a></p>
<p id="section-4.1-3">Implementations <span class="bcp14">MUST</span> follow the recommendations given in <span>[<a href="#RFC9325" class="cite xref">RFC9325</a>]</span>, especially in regards to recommended cipher suites and TLS session resumption.
Additionally, the following requirements have to be met for the (D)TLS session:<a href="#section-4.1-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.1-4.1">
            <p id="section-4.1-4.1.1">Support for TLS 1.2 <span>[<a href="#RFC5248" class="cite xref">RFC5248</a>]</span> / DTLS 1.2 <span>[<a href="#RFC6347" class="cite xref">RFC6347</a>]</span> is <span class="bcp14">REQUIRED</span>, support for TLS 1.3 <span>[<a href="#RFC8446" class="cite xref">RFC8446</a>]</span> / DTLS 1.3 <span>[<a href="#RFC9147" class="cite xref">RFC9147</a>]</span> or higher is <span class="bcp14">RECOMMENDED</span>.<a href="#section-4.1-4.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-4.1-4.2">
            <p id="section-4.1-4.2.1">Negotiation of a cipher suite providing for confidentiality as well as integrity protection is <span class="bcp14">REQUIRED</span>.<a href="#section-4.1-4.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-4.1-4.3">
            <p id="section-4.1-4.3.1">The peers <span class="bcp14">MUST NOT</span> negotiate compression.<a href="#section-4.1-4.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-4.1-4.4">
            <p id="section-4.1-4.4.1">The session <span class="bcp14">MUST</span> be mutually authenticated (see <a href="#mutual_auth" class="auto internal xref">Section 4.2</a>)<a href="#section-4.1-4.4.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="mutual_auth">
<section id="section-4.2">
        <h3 id="name-mutual-authentication">
<a href="#section-4.2" class="section-number selfRef">4.2. </a><a href="#name-mutual-authentication" class="section-name selfRef">Mutual authentication</a>
        </h3>
<p id="section-4.2-1">RADIUS/(D)TLS servers <span class="bcp14">MUST</span> authenticate clients, and RADIUS/(D)TLS clients <span class="bcp14">MUST</span> authenticate the server.
RADIUS is designed to be used by mutually trusted systems.
Allowing anonymous clients would ensure privacy for RADIUS/(D)TLS traffic, but would negate all other security aspects of the protocol, including security aspects of RADIUS itself, due to the fixed shared secret.<a href="#section-4.2-1" class="pilcrow">¶</a></p>
<p id="section-4.2-2">RADIUS/(D)TLS allows for the following different modes of mutual authentication, which will be further specified in this section:
* TLS-X.509-PKIX
* TLS-X.509-FINGERPRINT
* TLS-RAW-PUBLIC-KEY
* TLS-PSK<a href="#section-4.2-2" class="pilcrow">¶</a></p>
<div id="tlsx509pkix">
<section id="section-4.2.1">
          <h4 id="name-authentication-using-x509-c">
<a href="#section-4.2.1" class="section-number selfRef">4.2.1. </a><a href="#name-authentication-using-x509-c" class="section-name selfRef">Authentication using X.509 certificates with PKIX trust model (TLS-X.509-PKIX)</a>
          </h4>
<p id="section-4.2.1-1">All RADIUS/(D)TLS server implementations <span class="bcp14">MUST</span> implement this model.
RADIUS/(D)TLS client implementations <span class="bcp14">SHOULD</span> implement this model, but <span class="bcp14">MUST</span> implement either this or TLS-PSK<a href="#section-4.2.1-1" class="pilcrow">¶</a></p>
<p id="section-4.2.1-2">If implemented it <span class="bcp14">MUST</span> use the following rules:<a href="#section-4.2.1-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.2.1-3.1">
              <p id="section-4.2.1-3.1.1">Implementations <span class="bcp14">MUST</span> allow the configuration of a trust anchor (i.e. a list of trusted Certificate Authorities (CAs)<span>[<a href="#RFC5280" class="cite xref">RFC5280</a>]</span>) for new TLS sessions. This list <span class="bcp14">SHOULD</span> be application specific and not use a global system trust store.<a href="#section-4.2.1-3.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-4.2.1-3.2">
              <p id="section-4.2.1-3.2.1">Certificate validation <span class="bcp14">MUST</span> include the verification rules as per <span>[<a href="#RFC5280" class="cite xref">RFC5280</a>]</span>.<a href="#section-4.2.1-3.2.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-4.2.1-3.3">
              <p id="section-4.2.1-3.3.1">Implementations <span class="bcp14">SHOULD</span> indicate their trust anchors when opening or accepting TLS sessions.
See <span>[<a href="#RFC5246" class="cite xref">RFC5246</a>]</span>, Section 7.4.4 and <span>[<a href="#RFC6066" class="cite xref">RFC6066</a>]</span>, Section 6 for TLS 1.2 and <span>[<a href="#RFC8446" class="cite xref">RFC8446</a>]</span>, Section 4.2.4 for TLS 1.3.<a href="#section-4.2.1-3.3.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-4.2.1-3.4">
              <p id="section-4.2.1-3.4.1">When the configured trust base changes (e.g., removal of a CA from the trust anchor; issuance of a new CRL for a given CA), implementations <span class="bcp14">SHOULD</span> reassess all connected peer's continued validity of the certificate path. Note that TLS 1.3 no longer supports renegotiation to fulfill this requirement. <span class="cref" id="may-should-trustbase">Open discussion: RFC6614 says "may" here. I think this should be a "should". There are some discussions to change this to "must". Input from TLS/UTA experts is appreciated.<span class="crefSource">Janfred</span></span><a href="#section-4.2.1-3.4.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-4.2.1-4">RADIUS/(D)TLS clients and server <span class="bcp14">MUST</span> follow <span>[<a href="#RFC9525" class="cite xref">RFC9525</a>]</span> when validating peer identities. Specific details are provided below:<a href="#section-4.2.1-4" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.2.1-5.1">
              <p id="section-4.2.1-5.1.1">The Common Name RDN <span class="bcp14">MUST NOT</span> be used to identify peers<a href="#section-4.2.1-5.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-4.2.1-5.2">
              <p id="section-4.2.1-5.2.1">Certificates <span class="bcp14">MAY</span> use wildcards in the identifiers of DNS names and realm names, but only as the complete, left-most label.<a href="#section-4.2.1-5.2.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-4.2.1-5.3">
              <p id="section-4.2.1-5.3.1">RADIUS/(D)TLS clients validate the servers identity to match their local configuration, accepting the identity on the first match:<a href="#section-4.2.1-5.3.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.2.1-5.3.2.1">
                  <p id="section-4.2.1-5.3.2.1.1">If the expected RADIUS/(D)TLS server is associated with a specific NAI realm, e.g. by dynamic discovery <span>[<a href="#RFC7585" class="cite xref">RFC7585</a>]</span> or static configuration, that realm is matched against the presented identifiers of any subjectAltName entry of type otherName whose name form is NAIRealm as defined in <span>[<a href="#RFC7585" class="cite xref">RFC7585</a>]</span>.<a href="#section-4.2.1-5.3.2.1.1" class="pilcrow">¶</a></p>
</li>
                <li class="normal" id="section-4.2.1-5.3.2.2">
                  <p id="section-4.2.1-5.3.2.2.1">If the expected RADIUS/(D)TLS server was configured as a hostname, or the hostname was yielded by a dynamic discovery procedure, that name is matched against the presented identifiers of any subjectAltName entry of type dNSName <span>[<a href="#RFC5280" class="cite xref">RFC5280</a>]</span>. Since a dynamic discovery might by itself not be secured, implementations <span class="bcp14">MAY</span> require the use of DNSSEC <span>[<a href="#RFC4033" class="cite xref">RFC4033</a>]</span> to ensure the authenticity of the DNS result before considering this identity as valid.<a href="#section-4.2.1-5.3.2.2.1" class="pilcrow">¶</a></p>
</li>
                <li class="normal" id="section-4.2.1-5.3.2.3">
                  <p id="section-4.2.1-5.3.2.3.1">If the expected RADIUS/(D)TLS server was configured as an IP address, the configured IP address is matched against the presented identifier in any subjectAltName entry of type iPAddress <span>[<a href="#RFC5280" class="cite xref">RFC5280</a>]</span>.<a href="#section-4.2.1-5.3.2.3.1" class="pilcrow">¶</a></p>
</li>
                <li class="normal" id="section-4.2.1-5.3.2.4">
                  <p id="section-4.2.1-5.3.2.4.1">Clients <span class="bcp14">MAY</span> use other attributes of the certificate to validate the servers identity, but it <span class="bcp14">MUST NOT</span> accept any certificate without validation.<a href="#section-4.2.1-5.3.2.4.1" class="pilcrow">¶</a></p>
</li>
                <li class="normal" id="section-4.2.1-5.3.2.5">
                  <p id="section-4.2.1-5.3.2.5.1">Clients which also act as servers (i.e. proxies) may be susceptible to security issues when a ClientHello is mirrored back to themselves. More details on this issue are discussed in <a href="#security_considerations" class="auto internal xref">Section 7</a>.<a href="#section-4.2.1-5.3.2.5.1" class="pilcrow">¶</a></p>
</li>
              </ul>
</li>
            <li class="normal" id="section-4.2.1-5.4">
              <p id="section-4.2.1-5.4.1">RADIUS/(D)TLS servers validate the certificate of the RADIUS/(D)TLS client against a local database of acceptable clients.
The database may enumerate acceptable clients either by IP address or by a name component in the certificate.<a href="#section-4.2.1-5.4.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.2.1-5.4.2.1">
                  <p id="section-4.2.1-5.4.2.1.1">For clients configured by DNS name, the configured name is matched against the presented identifiers of any subjectAltName entry of type dNSName <span>[<a href="#RFC5280" class="cite xref">RFC5280</a>]</span>.<a href="#section-4.2.1-5.4.2.1.1" class="pilcrow">¶</a></p>
</li>
                <li class="normal" id="section-4.2.1-5.4.2.2">
                  <p id="section-4.2.1-5.4.2.2.1">For clients configured by their source IP address, the configured IP address is matched against the presented identifiers of any subjectAltName entry of type iPAddress <span>[<a href="#RFC5280" class="cite xref">RFC5280</a>]</span>.
For clients configured by IP range, the certificate <span class="bcp14">MUST</span> be valid for the IP address the client is currently using.<a href="#section-4.2.1-5.4.2.2.1" class="pilcrow">¶</a></p>
</li>
                <li class="normal" id="section-4.2.1-5.4.2.3">
                  <p id="section-4.2.1-5.4.2.3.1">Implementation <span class="bcp14">MAY</span> consider additional subjectAltName extensions to identify a client.<a href="#section-4.2.1-5.4.2.3.1" class="pilcrow">¶</a></p>
</li>
                <li class="normal" id="section-4.2.1-5.4.2.4">
                  <p id="section-4.2.1-5.4.2.4.1">If configured by the administrator, the identity check <span class="bcp14">MAY</span> be omitted after a successful <span>[<a href="#RFC5280" class="cite xref">RFC5280</a>]</span> trust chain check, e.g. if the client used dynamic lookup there is no configured client identity to verify. The clients authorization <span class="bcp14">MUST</span> then be validated using a certificate policy OID unless both peers are part of a trusted network.<a href="#section-4.2.1-5.4.2.4.1" class="pilcrow">¶</a></p>
</li>
              </ul>
</li>
            <li class="normal" id="section-4.2.1-5.5">
              <p id="section-4.2.1-5.5.1">Implementations <span class="bcp14">MAY</span> allow configuration of a set of additional properties of the certificate to check for a peer's authorization to communicate (e.g. a set of allowed values presented in  subjectAltName entries of type uniformResourceIdentifier <span>[<a href="#RFC5280" class="cite xref">RFC5280</a>]</span> or a set of allowed X.509v3 Certificate Policies).<a href="#section-4.2.1-5.5.1" class="pilcrow">¶</a></p>
</li>
          </ul>
</section>
</div>
<div id="authentication-using-x509-certificate-fingerprints-tls-x509-fingerprint">
<section id="section-4.2.2">
          <h4 id="name-authentication-using-x509-ce">
<a href="#section-4.2.2" class="section-number selfRef">4.2.2. </a><a href="#name-authentication-using-x509-ce" class="section-name selfRef">Authentication using X.509 certificate fingerprints (TLS-X.509-FINGERPRINT)</a>
          </h4>
<p id="section-4.2.2-1">RADIUS/(D)TLS implementations <span class="bcp14">SHOULD</span> allow the configuration of a list of trusted certificates, identified via fingerprint of the DER encoded certificate bytes.
When implementing this model, support for SHA-1 as hash algorithm for the fingerprint is <span class="bcp14">REQUIRED</span>, and support for the more contemporary hash function SHA-256 is <span class="bcp14">RECOMMENDED</span>.<a href="#section-4.2.2-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="authentication-using-raw-public-keys-tls-raw-public-keys">
<section id="section-4.2.3">
          <h4 id="name-authentication-using-raw-pu">
<a href="#section-4.2.3" class="section-number selfRef">4.2.3. </a><a href="#name-authentication-using-raw-pu" class="section-name selfRef">Authentication using Raw Public Keys (TLS-RAW-PUBLIC-KEYS)</a>
          </h4>
<p id="section-4.2.3-1">RADIUS/(D)TLS implementations <span class="bcp14">SHOULD</span> support using Raw Public Keys <span>[<a href="#RFC7250" class="cite xref">RFC7250</a>]</span> for mutual authentication.<a href="#section-4.2.3-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="tlspsk">
<section id="section-4.2.4">
          <h4 id="name-authentication-using-tls-ps">
<a href="#section-4.2.4" class="section-number selfRef">4.2.4. </a><a href="#name-authentication-using-tls-ps" class="section-name selfRef">Authentication using TLS-PSK (TLS-PSK)</a>
          </h4>
<p id="section-4.2.4-1">RADIUS/(D)TLS server implementations <span class="bcp14">MUST</span> support the use of TLS-PSK.
RADIUS/(D)TLS client implementations <span class="bcp14">SHOULD</span> support the use of TLS-PSK, but <span class="bcp14">MUST</span> implement either this or the TLS-X.509-PKIX trust model.<a href="#section-4.2.4-1" class="pilcrow">¶</a></p>
<p id="section-4.2.4-2">Further guidance on the usage of TLS-PSK in RADIUS/(D)TLS is given in <span>[<a href="#I-D.ietf-radext-tls-psk" class="cite xref">I-D.ietf-radext-tls-psk</a>]</span>.<a href="#section-4.2.4-2" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="connecting-client-identity">
<section id="section-4.3">
        <h3 id="name-connecting-client-identity">
<a href="#section-4.3" class="section-number selfRef">4.3. </a><a href="#name-connecting-client-identity" class="section-name selfRef">Connecting Client Identity</a>
        </h3>
<p id="section-4.3-1">In RADIUS/UDP, clients are uniquely identified by their IP addresses.
Since the shared secret is associated with the origin IP address, if more than one RADIUS client is associated with the same IP address, then those clients also must utilize the same shared secret, a practice that is inherently insecure, as noted in <span>[<a href="#RFC5247" class="cite xref">RFC5247</a>]</span>.<a href="#section-4.3-1" class="pilcrow">¶</a></p>
<p id="section-4.3-2">Depending on the trust model used, the RADIUS/(D)TLS client identity can be determined differently.<a href="#section-4.3-2" class="pilcrow">¶</a></p>
<p id="section-4.3-3">With TLS-PSK, a client is uniquely identified by its TLS-PSK identifier.<a href="#section-4.3-3" class="pilcrow">¶</a></p>
<p id="section-4.3-4">With TLS-RAW-PUBLIC-KEY, a client is uniquely identified by the Raw public key.<a href="#section-4.3-4" class="pilcrow">¶</a></p>
<p id="section-4.3-5">With TLS-X.509-FINGERPRINT, a client is uniquely identified by the fingerprint of the presented client certificate.<a href="#section-4.3-5" class="pilcrow">¶</a></p>
<p id="section-4.3-6">With TLS-X.509-PKIX, a client is uniquely identified by the tuple of the serial number of the presented client certificate and the issuer.<a href="#section-4.3-6" class="pilcrow">¶</a></p>
<p id="section-4.3-7">Note well: having identified a connecting entity does not mean the server necessarily wants to communicate with that client.
For example, if the Issuer is not in a trusted set of Issuers, the server may decline to perform RADIUS transactions with this client.<a href="#section-4.3-7" class="pilcrow">¶</a></p>
<p id="section-4.3-8">Additionally, a server <span class="bcp14">MAY</span> restrict individual or groups of clients to certain IP ranges.
A client connecting from outside this range would be rejected, even if the mutual authentication otherwise would have been successful.
To reduce server load and to prevent probing the validity of stolen credentials, the server <span class="bcp14">SHOULD</span> abort the (D)TLS negotiation immediately with a TLS alert access_denied(49) after the client transmitted identifying information, i.e. the client certificate or the PSK identifier, and the server recognizes that the client connects from outside the allowed IP range.<a href="#section-4.3-8" class="pilcrow">¶</a></p>
<p id="section-4.3-9">There are numerous trust models in PKIX environments, and it is beyond the scope of this document to define how a particular deployment determines whether a client is trustworthy.
Implementations that want to support a wide variety of trust models should expose as many details of the presented certificate to the administrator as possible so that the trust model can be implemented by the administrator.
As a suggestion, at least the following parameters of the X.509 client certificate should be exposed:<a href="#section-4.3-9" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.3-10.1">
            <p id="section-4.3-10.1.1">Originating IP address<a href="#section-4.3-10.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-4.3-10.2">
            <p id="section-4.3-10.2.1">Certificate Fingerprint<a href="#section-4.3-10.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-4.3-10.3">
            <p id="section-4.3-10.3.1">Issuer<a href="#section-4.3-10.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-4.3-10.4">
            <p id="section-4.3-10.4.1">Subject<a href="#section-4.3-10.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-4.3-10.5">
            <p id="section-4.3-10.5.1">all X.509v3 Extended Key Usage<a href="#section-4.3-10.5.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-4.3-10.6">
            <p id="section-4.3-10.6.1">all X.509v3 Subject Alternative Name<a href="#section-4.3-10.6.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-4.3-10.7">
            <p id="section-4.3-10.7.1">all X.509v3 Certificate Policy<a href="#section-4.3-10.7.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-4.3-11">In TLS-PSK operation at least the following parameters of the TLS connection should be exposed:<a href="#section-4.3-11" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.3-12.1">
            <p id="section-4.3-12.1.1">Originating IP address<a href="#section-4.3-12.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-4.3-12.2">
            <p id="section-4.3-12.2.1">TLS-PSK Identifier<a href="#section-4.3-12.2.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="radius_datagrams">
<section id="section-4.4">
        <h3 id="name-radius-datagrams">
<a href="#section-4.4" class="section-number selfRef">4.4. </a><a href="#name-radius-datagrams" class="section-name selfRef">RADIUS Datagrams</a>
        </h3>
<p id="section-4.4-1">RADIUS/(D)TLS clients transmit the same packet types on the connection they initiated as a RADIUS/UDP client would, RADIUS/(D)TLS servers transmit the same packet types on the connections they have accepted as a RADIUS/UDP server would.<a href="#section-4.4-1" class="pilcrow">¶</a></p>
<p id="section-4.4-2">Due to the use of one single port for all packet types, it is required that a RADIUS/(D)TLS server signals which types of packets are supported on a server to a connecting peer.<a href="#section-4.4-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.4-3.1">
            <p id="section-4.4-3.1.1">When an unwanted packet of type 'CoA-Request' or 'Disconnect-Request' is received, a RADIUS/(D)TLS server needs to respond with a 'CoA-NAK' or 'Disconnect-AK', respectively.
The NAK <span class="bcp14">SHOULD</span> contain an attribute Error-Cause with the value 406 ("Unsupported Extension"); see <span>[<a href="#RFC5176" class="cite xref">RFC5176</a>]</span> for details.<a href="#section-4.4-3.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-4.4-3.2">
            <p id="section-4.4-3.2.1">When an unwanted packet of type 'Accounting-Request' is received, the RADIUS/(D)TLS server <span class="bcp14">SHOULD</span> reply with an Accounting-Response containing an Error-Cause attribute with value 406 "Unsupported Extensions" as defined in <span>[<a href="#RFC5176" class="cite xref">RFC5176</a>]</span>.
A RADIUS/(D)TLS accounting client receiving such an Accounting-Response <span class="bcp14">SHOULD</span> log the error and stop sending Accounting-Request packets.<span class="cref" id="send_protocol_error_instead">TODO: Comment from Alan to send a Protocol Error packet instead.<span class="crefSource">Janfred</span></span><a href="#section-4.4-3.2.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="forwarding-radius-packets-between-udp-and-tcp-based-transports">
<section id="section-4.5">
        <h3 id="name-forwarding-radius-packets-b">
<a href="#section-4.5" class="section-number selfRef">4.5. </a><a href="#name-forwarding-radius-packets-b" class="section-name selfRef">Forwarding RADIUS packets between UDP and TCP based transports</a>
        </h3>
<p id="section-4.5-1">When proxy forwards packets, it is possible that the incoming and outgoing links have substantially different properties.  This issue is most notable in UDP to TCP proxying, but there are still possible issues even when the same transport is used on both incoming and outgoing links.  <span>[<a href="#RFC2866" class="cite xref">RFC2866</a>], <a href="https://rfc-editor.org/rfc/rfc2866#section-1.2" class="relref">Section 1.2</a></span> noted this issue many years ago:<a href="#section-4.5-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.5-2">
<pre>
A forwarding server may either perform its forwarding function in a
pass through manner, where it sends retransmissions on as soon as it
gets them, or it may take responsibility for retransmissions, for
example in cases where the network link between forwarding and remote
server has very different characteristics than the link between NAS
and forwarding server.
</pre><a href="#section-4.5-2" class="pilcrow">¶</a>
</div>
<p id="section-4.5-3">These differences are most notable in throughput, and in differing retransmission requirements.<a href="#section-4.5-3" class="pilcrow">¶</a></p>
<div id="throughput-differences-lead-to-network-collapse">
<section id="section-4.5.1">
          <h4 id="name-throughput-differences-lead">
<a href="#section-4.5.1" class="section-number selfRef">4.5.1. </a><a href="#name-throughput-differences-lead" class="section-name selfRef">Throughput Differences lead to Network Collapse</a>
          </h4>
<p id="section-4.5.1-1">An incoming link to the proxy may have substantially lower throughput than the outgoing link.  Perhaps the network characteristics on the two links are different, or perhaps the home server is slow.  In both situations, the proxy is left with a difficult choice about what to do with the incoming packets.<a href="#section-4.5.1-1" class="pilcrow">¶</a></p>
<p id="section-4.5.1-2">As RADIUS does not provide for connection-based congestion control, there is no way for the proxy to signal on the incoming link that the client should slow its rate of sending packets.  As a result, the proxy must simply accept the packets, buffer them, and hope that they can be be sent outbound before the client gives up on the request.<a href="#section-4.5.1-2" class="pilcrow">¶</a></p>
<p id="section-4.5.1-3">The situation is made worse by the sub-optimal behavior of Accounting-Request packets.  <span>[<a href="#RFC2866" class="cite xref">RFC2866</a>], <a href="https://rfc-editor.org/rfc/rfc2866#section-5.2" class="relref">Section 5.2</a></span> defines the Acct-Delay-Time attribute, which is supposed to be updated on retransmissions.  However, when the value of the attribute is updated, changing the Acct-Delay-Time causes the Identifier to change.  The "retransmitted" packet is therefore not, in fact, retransmitted, but is instead a brand new packet.  This behavior increases the number of packets handled by proxies, which leads to congestive collapse.  This design also violates the "end-to-end" principles discussed in <span>[<a href="#RFC3539" class="cite xref">RFC3539</a>], <a href="https://rfc-editor.org/rfc/rfc3539#section-2.8" class="relref">Section 2.8</a></span> which discusses congestion avoidance:<a href="#section-4.5.1-3" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.5.1-4">
<pre>
With Relays, Proxies or Store and Forward proxies, two separate and
de-coupled transport connections are used.  One connection operates
between the AAA client and agent, and another between the agent and
server.  Since the two transport connections are de-coupled,
transport layer ACKs do not flow end-to-end, and self-clocking does
not occur.
</pre><a href="#section-4.5.1-4" class="pilcrow">¶</a>
</div>
<p id="section-4.5.1-5">In order to avoid congestive collapse, is is <span class="bcp14">RECOMMENDED</span> that RADIUS/TLS clients which originate Accounting-Request packets (i.e. not proxies) do not include Acct-Delay-Time in those packets.  Instead, those clients <span class="bcp14">SHOULD</span> include Event-Timestamp, which is the time at which the original event occurred.  The Event-Timestamp <span class="bcp14">MUST NOT</span> be updated on any retransmissions, as that would both negate the meaning of Event-Timestamp, and also create the same problem as with Acct-Delay-Time.<a href="#section-4.5.1-5" class="pilcrow">¶</a></p>
<p id="section-4.5.1-6">This change is imperfect, but will at least help to avoid congestive collapse.<a href="#section-4.5.1-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="differing-retransmission-requirements">
<section id="section-4.5.2">
          <h4 id="name-differing-retransmission-re">
<a href="#section-4.5.2" class="section-number selfRef">4.5.2. </a><a href="#name-differing-retransmission-re" class="section-name selfRef">Differing Retransmission Requirements</a>
          </h4>
<p id="section-4.5.2-1">Due to the lossy nature of UDP, RADIUS/UDP and RADIUS/DTLS transports are required to perform retransmissions as per <span>[<a href="#RFC5080" class="cite xref">RFC5080</a>], <a href="https://rfc-editor.org/rfc/rfc5080#section-2.2.1" class="relref">Section 2.2.1</a></span>.  In contrast, RADIUS/TCP and RADIUS/TLS transports are reliable, and do not perform retransmissions.  These requirements lead to an issue for proxies when they send packets across protocol boundaries with differing retransmission behaviors.<a href="#section-4.5.2-1" class="pilcrow">¶</a></p>
<p id="section-4.5.2-2">When a proxy receives packets on an unreliable transport, and forwards them across a reliable transport, it receives retransmissions from the client, but <span class="bcp14">MUST NOT</span> forward those retransmissions across the reliable transport.  The proxy <span class="bcp14">MAY</span> log information about these retransmissions, but it does not perform any other action.<a href="#section-4.5.2-2" class="pilcrow">¶</a></p>
<p id="section-4.5.2-3">When a proxy receives packets on a reliable transport, and forwards them across an unreliable transport, the proxy <span class="bcp14">MUST</span> perform retransmissions across the unreliable transport as per <span>[<a href="#RFC5080" class="cite xref">RFC5080</a>], <a href="https://rfc-editor.org/rfc/rfc5080#section-2.2.1" class="relref">Section 2.2.1</a></span>.  That is, the proxy takes responsibility for the retransmissions.  Implementations <span class="bcp14">MUST</span> take care to not completely decouple the two transports in this situation.<a href="#section-4.5.2-3" class="pilcrow">¶</a></p>
<p id="section-4.5.2-4">That is, if an incoming connection on a reliable transport is closed, there may be pending retransmissions on an outgoing unreliable transport.  Those retransmissions <span class="bcp14">MUST</span> be stopped, as there is nowhere to send the reply.  Similarly, if the proxy sees that the client has given up on a request (such as by re-using an Identifier before the proxy has sent a response), the proxy <span class="bcp14">MUST</span> stop all retransmissions, and discard the old request.<a href="#section-4.5.2-4" class="pilcrow">¶</a></p>
<p id="section-4.5.2-5">The above requirements are a logical extension of the common practice where a client stops retransmission of a packet once it decides to "give up" on the packet and discard it.  Whether this discard process is due to internal client decisions, or interaction with incoming connections is irrelevant.  When the client cannot do anything with responses to a request, it <span class="bcp14">MUST</span> stop retransmitting that request.<a href="#section-4.5.2-5" class="pilcrow">¶</a></p>
<p id="section-4.5.2-6">In an ideal world, a proxy could also apply the suggestion of the previous section, by discarding Acct-Delay-Time from Accounting-Request packets, and replacing it with Event-Timestamp.  However, this process is fragile and is not known to succeed in the general case.<a href="#section-4.5.2-6" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="session-limits-and-timeout">
<section id="section-4.6">
        <h3 id="name-session-limits-and-timeout">
<a href="#section-4.6" class="section-number selfRef">4.6. </a><a href="#name-session-limits-and-timeout" class="section-name selfRef">Session limits and timeout</a>
        </h3>
<p id="section-4.6-1">While RADIUS/UDP could be implemented mostly stateless (except for the requests in flight), both TCP/TLS as well as DTLS require state tracking of the underlying TLS connection and are thus subject to potential resource exhaustion. This is aggravated by the fact that radius client/servers are often statically configured and thus form long-running peer relationships with long-running connections.<a href="#section-4.6-1" class="pilcrow">¶</a></p>
<p id="section-4.6-2">Implementations <span class="bcp14">SHOULD</span> have configurable limits on the number of open connections. When this maximum is reached and a new session is started, the server <span class="bcp14">MUST</span> either drop an old session in order to open the new one or not create a new session.<a href="#section-4.6-2" class="pilcrow">¶</a></p>
<p id="section-4.6-3">The close notification of (D)TLS or underlying connections are not fully reliable, or they might be unnecessarily kept alive by heartbeat or watchdog traffic, occupying resources.
Therefore, both RADIUS/(D)TLS clients and servers <span class="bcp14">MAY</span> close connections after they have been idle for some time (no traffic except application layer watchdog). This idle timeout <span class="bcp14">SHOULD</span> be configurable within reasonable limits and <span class="bcp14">SHOULD</span> allow to disable idle timeout completely.<a href="#section-4.6-3" class="pilcrow">¶</a></p>
<p id="section-4.6-4">On the server side, this mostly helps avoid resource exhaustion. For clients, proactively closing sessions can also help mitigate situations where watchdog mechanisms are unavailable or fail to detect non-functional connections. Some scenarios or RADIUS protocol extensions could also require that a connection be kept open at all times, so clients <span class="bcp14">MAY</span> immediately re-open the connection. These scenarios could be related to monitoring the infrastructure or to allow the server to proactively send packets to the clients without a preceding request.<a href="#section-4.6-4" class="pilcrow">¶</a></p>
<p id="section-4.6-5">The value of the idle timeout to use depends on the exact deployment and is a trade-of between resource usage on clients/servers and the overhead of opening new connections. Very short timeouts that are at or below the timeouts used for application layer watchdogs, typically in the range of 30-60s can be considered unreasonable. In contrast, the upper limit is much more difficult to define but may be in the range of 10 to 15min, depending on the available resources, or never (disabling idle timeout) in scenarios where a permanently open connection is required.<a href="#section-4.6-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="malformed-packets-and-unknown-clients">
<section id="section-4.7">
        <h3 id="name-malformed-packets-and-unkno">
<a href="#section-4.7" class="section-number selfRef">4.7. </a><a href="#name-malformed-packets-and-unkno" class="section-name selfRef">Malformed Packets and Unknown clients</a>
        </h3>
<p id="section-4.7-1">The RADIUS specifications say that an implementation should "silently discard" a packet in a number of circumstances.
This action has no further consequences for UDP based transports, as the "next" packet is completely independent of the previous one.<a href="#section-4.7-1" class="pilcrow">¶</a></p>
<p id="section-4.7-2">When TLS is used as transport, decoding the "next" packet on a connection depends on the proper decoding of the previous packet.
As a result the behavior with respect to discarded packets has to change, since a malformed RADIUS packet could impact the decoding of succeeding packets.<a href="#section-4.7-2" class="pilcrow">¶</a></p>
<p id="section-4.7-3">With DTLS, the "next" packet does not depend on proper decoding of the previous packet, since the RADIUS packets are sent in independent DTLS records.
However, since both TLS and DTLS provide integrity protection and ensure that the packet was sent by the peer, a protocol violation at this stage implies that the peer is misbehaving.<a href="#section-4.7-3" class="pilcrow">¶</a></p>
<p id="section-4.7-4">Implementations of this specification <span class="bcp14">SHOULD</span> treat the "silently discard" texts in the RADIUS specification referenced above as "silently discard and close the connection".
That is, the implementation <span class="bcp14">SHOULD</span> send a TLS close notification and, in the case of RADIUS/TLS, the underlying TCP connection <span class="bcp14">MUST</span> be closed if any of the following circumstances are seen:<a href="#section-4.7-4" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.7-5.1">
            <p id="section-4.7-5.1.1">Connection from an unknown client<a href="#section-4.7-5.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-4.7-5.2">
            <p id="section-4.7-5.2.1">Packet where the RADIUS "Length" field is less than the minimum RADIUS packet length<a href="#section-4.7-5.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-4.7-5.3">
            <p id="section-4.7-5.3.1">Packet where the RADIUS "Length" field is more than the maximum RADIUS packet length<a href="#section-4.7-5.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-4.7-5.4">
            <p id="section-4.7-5.4.1">Packet where an Attribute "Length" field has the value of zero or one (0 or 1)<a href="#section-4.7-5.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-4.7-5.5">
            <p id="section-4.7-5.5.1">Packet where the attributes do not exactly fill the packet<a href="#section-4.7-5.5.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-4.7-5.6">
            <p id="section-4.7-5.6.1">Packet where the Request Authenticator fails validation (where validation is required)<a href="#section-4.7-5.6.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-4.7-5.7">
            <p id="section-4.7-5.7.1">Packet where the Response Authenticator fails validation (where validation is required)<a href="#section-4.7-5.7.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-4.7-5.8">
            <p id="section-4.7-5.8.1">Packet where the Message-Authenticator attribute fails validation (when it occurs in a packet)<a href="#section-4.7-5.8.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-4.7-6">After applying the above rules, there are still two situations where the previous specifications allow a packet to be "silently discarded" upon receipt:<a href="#section-4.7-6" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.7-7.1">
            <p id="section-4.7-7.1.1">Packet with an invalid code field<a href="#section-4.7-7.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-4.7-7.2">
            <p id="section-4.7-7.2.1">Response packets that do not match any outstanding request<a href="#section-4.7-7.2.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-4.7-8">In these situations, the (D)TLS connections <span class="bcp14">MAY</span> remain open, or they <span class="bcp14">MAY</span> be closed, as an implementation choice. However, the invalid packet <span class="bcp14">MUST</span> be silently discarded.<a href="#section-4.7-8" class="pilcrow">¶</a></p>
<p id="section-4.7-9">These requirements reduce the possibility for a misbehaving client or server to wreak havoc on the network.<a href="#section-4.7-9" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="radiustls-specific-specifications">
<section id="section-5">
      <h2 id="name-radius-tls-specific-specifi">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-radius-tls-specific-specifi" class="section-name selfRef">RADIUS/TLS specific specifications</a>
      </h2>
<p id="section-5-1">This section discusses all specifications that are only relevant for RADIUS/TLS.<a href="#section-5-1" class="pilcrow">¶</a></p>
<div id="duplicates-and-retransmissions">
<section id="section-5.1">
        <h3 id="name-duplicates-and-retransmissi">
<a href="#section-5.1" class="section-number selfRef">5.1. </a><a href="#name-duplicates-and-retransmissi" class="section-name selfRef">Duplicates and Retransmissions</a>
        </h3>
<p id="section-5.1-1">As TCP is a reliable transport, RADIUS/TLS peers <span class="bcp14">MUST NOT</span> retransmit RADIUS packets over a given TCP connection.
Similarly, if there is no response to a RADIUS packet over one RADIUS/TLS connection, implementations <span class="bcp14">MUST NOT</span> retransmit that packet over a different connection to the same destination IP address and port, while the first connection is in the OKAY state (<span>[<a href="#RFC3539" class="cite xref">RFC3539</a>], <a href="https://rfc-editor.org/rfc/rfc3539#appendix-A" class="relref">Appendix A</a></span>. <span class="cref" id="what_is_a_server_2">TODO: Destination IP addr and port may be bad, but what is a server's identity?<span class="crefSource">Janfred</span></span><a href="#section-5.1-1" class="pilcrow">¶</a></p>
<p id="section-5.1-2">However, if the TLS session or TCP connection is closed or broken, retransmissions over new connections are permissible.
RADIUS request packets that have not yet received a response <span class="bcp14">MAY</span> be transmitted by a RADIUS/TLS client over a new connection.
As this procedure involves using a new source port, the ID of the packet <span class="bcp14">MAY</span> change.
If the ID changes, any security attributes such as Message-Authenticator <span class="bcp14">MUST</span> be recalculated.<a href="#section-5.1-2" class="pilcrow">¶</a></p>
<p id="section-5.1-3">If a TLS session or the underlying TCP connection is closed or broken, any cached RADIUS response packets (<span>[<a href="#RFC5080" class="cite xref">RFC5080</a>], <a href="https://rfc-editor.org/rfc/rfc5080#section-2.2.2" class="relref">Section 2.2.2</a></span>) associated with that connection <span class="bcp14">MUST</span> be discarded.
A RADIUS server <span class="bcp14">SHOULD</span> stop the processing of any requests associated with that TLS session.
No response to these requests can be sent over the TLS connection, so any further processing is pointless.
This requirement applies not only to RADIUS servers, but also to proxies.
When a client's connection to a proxy is closed, there may be responses from a home server that were supposed to be sent by the proxy back over that connection to the client.
Since the client connection is closed, those responses from the home server to the proxy server <span class="bcp14">SHOULD</span> be silently discarded by the proxy.<a href="#section-5.1-3" class="pilcrow">¶</a></p>
<p id="section-5.1-4">Despite the above discussion, RADIUS servers <span class="bcp14">SHOULD</span> still perform duplicate detection on received packets, as described in <span>[<a href="#RFC5080" class="cite xref">RFC5080</a>], <a href="https://rfc-editor.org/rfc/rfc5080#section-2.2.2" class="relref">Section 2.2.2</a></span>.
This detection can prevent duplicate processing of packets from non-conforming clients.<a href="#section-5.1-4" class="pilcrow">¶</a></p>
<p id="section-5.1-5">RADIUS packets <span class="bcp14">SHOULD NOT</span> be retransmitted to the same destination IP and numerical port, but over a different transport protocol.
There is no guarantee in RADIUS that the two ports are in any way related.
This requirement does not, however, forbid the practice of putting multiple servers into a failover or load-balancing pool.
In that situation, RADIUS requests <span class="bcp14">MAY</span> be retransmitted to another server that is known to be part of the same pool.<a href="#section-5.1-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="tcp-applications-are-not-udp-applications">
<section id="section-5.2">
        <h3 id="name-tcp-applications-are-not-ud">
<a href="#section-5.2" class="section-number selfRef">5.2. </a><a href="#name-tcp-applications-are-not-ud" class="section-name selfRef">TCP Applications Are Not UDP Applications</a>
        </h3>
<p id="section-5.2-1">Implementors should be aware that programming a robust TCP-based application can be very different from programming a robust UDP-based application.<a href="#section-5.2-1" class="pilcrow">¶</a></p>
<p id="section-5.2-2">Additionally, differences in the transport like Head of Line (HoL) blocking should be considered.<a href="#section-5.2-2" class="pilcrow">¶</a></p>
<p id="section-5.2-3">When using RADIUS/UDP or RADIUS/DTLS, there is no ordering of packets.
If a packet sent by a peer is lost, that loss has no effect on subsequent packets sent by that peer.<a href="#section-5.2-3" class="pilcrow">¶</a></p>
<p id="section-5.2-4">Unlike UDP, TCP is subject to issues related to Head of Line blocking.
This occurs when a TCP segment is lost and a subsequent TCP segment arrives out of order.
While the RADIUS peers can process RADIUS packets out of order, the semantics of TCP makes this impossible.
This limitation can lower the maximum packet processing rate of RADIUS/TLS.<a href="#section-5.2-4" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="dtls_spec">
<section id="section-6">
      <h2 id="name-radius-dtls-specific-specif">
<a href="#section-6" class="section-number selfRef">6. </a><a href="#name-radius-dtls-specific-specif" class="section-name selfRef">RADIUS/DTLS specific specifications</a>
      </h2>
<p id="section-6-1">This section discusses all specifications that are only relevant for RADIUS/DTLS.<a href="#section-6-1" class="pilcrow">¶</a></p>
<div id="radius-packet-lengths">
<section id="section-6.1">
        <h3 id="name-radius-packet-lengths">
<a href="#section-6.1" class="section-number selfRef">6.1. </a><a href="#name-radius-packet-lengths" class="section-name selfRef">RADIUS packet lengths</a>
        </h3>
<p id="section-6.1-1">The DTLS encryption adds an additional overhead to each packet sent.
RADIUS/DTLS implementations <span class="bcp14">MUST</span> support sending and receiving RADIUS packets of 4096 bytes in length, with a corresponding increase in the maximum size of the encapsulated DTLS packets.
This larger packet size may cause the packet to be larger than the Path MTU (PMTU), where a RADIUS/UDP packet may be smaller.<a href="#section-6.1-1" class="pilcrow">¶</a></p>
<p id="section-6.1-2">The length checks defined in <span>[<a href="#RFC2865" class="cite xref">RFC2865</a>], <a href="https://rfc-editor.org/rfc/rfc2865#section-3" class="relref">Section 3</a></span> still apply, but <span class="bcp14">MUST</span> use the length of the decrypted DTLS record instead of the UDP packet length.
Exaclty one RADIUS packet is encapsulated in a DTLS record, and any decrypted octets outside the range of the length field within a single DTLS record <span class="bcp14">MUST</span> be treated as padding and be ignored.
Note that multiple DTLS records may be sent in a single UDP datagram.<a href="#section-6.1-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="server-behavior">
<section id="section-6.2">
        <h3 id="name-server-behavior">
<a href="#section-6.2" class="section-number selfRef">6.2. </a><a href="#name-server-behavior" class="section-name selfRef">Server behavior</a>
        </h3>
<p id="section-6.2-1">When a RADIUS/DTLS server receives packets on the configured RADIUS/DTLS port, all packets <span class="bcp14">MUST</span> be treated as being DTLS.
RADIUS/UDP packets <span class="bcp14">MUST NOT</span> be accepted on this port.<a href="#section-6.2-1" class="pilcrow">¶</a></p>
<p id="section-6.2-2">Some servers maintain a list of allowed clients per destination port.
Others maintain a global list of clients that are permitted to send packets to any port.
Where a client can send packets to multiple ports, the server <span class="bcp14">MUST</span> maintain a "DTLS Required" flag per client.<a href="#section-6.2-2" class="pilcrow">¶</a></p>
<p id="section-6.2-3">This flag indicates whether or not the client is required to use DTLS.
When set, the flag indicates that the only traffic accepted from the client is over the RADIUS/DTLS port.
When packets are received from a client with the "DTLS Required" flag set on non-DTLS ports, the server <span class="bcp14">MUST</span> silently discard these packets, as there is no RADIUS/UDP shared secret available.<a href="#section-6.2-3" class="pilcrow">¶</a></p>
<p id="section-6.2-4">This flag will often be set by an administrator.
However, if the server receives DTLS traffic from a client, it <span class="bcp14">SHOULD</span> notify the administrator that DTLS is available for that client.
It <span class="bcp14">MAY</span> mark the client as "DTLS Required".<a href="#section-6.2-4" class="pilcrow">¶</a></p>
<p id="section-6.2-5">Allowing RADIUS/UDP and RADIUS/DTLS from the same client exposes the traffic to downbidding attacks and is <span class="bcp14">NOT RECOMMENDED</span>.<a href="#section-6.2-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="client-behavior">
<section id="section-6.3">
        <h3 id="name-client-behavior">
<a href="#section-6.3" class="section-number selfRef">6.3. </a><a href="#name-client-behavior" class="section-name selfRef">Client behavior</a>
        </h3>
<p id="section-6.3-1">When a RADIUS/DTLS client sends packet to the assigned RADIUS/DTLS port, all packets <span class="bcp14">MUST</span> be DTLS.
RADIUS/UDP packets <span class="bcp14">MUST NOT</span> be sent to this port.<a href="#section-6.3-1" class="pilcrow">¶</a></p>
<p id="section-6.3-2">RADIUS/DTLS clients <span class="bcp14">SHOULD NOT</span> probe servers to see if they support DTLS transport.
Instead, clients <span class="bcp14">SHOULD</span> use DTLS as a transport layer only when administratively configured.
If a client is configured to use DTLS and the server appears to be unresponsive, the client <span class="bcp14">MUST NOT</span> fall back to using RADIUS/UDP.
Instead, the client should treat the server as being down.<a href="#section-6.3-2" class="pilcrow">¶</a></p>
<p id="section-6.3-3">RADIUS clients often had multiple independent RADIUS implementations and/or processes that originate packets.
This practice was simple to implement, but the result is that each independent subsystem must independently discover network issues or server failures.
It is therefore <span class="bcp14">RECOMMENDED</span> that clients with multiple internal RADIUS sources use a local proxy.<a href="#section-6.3-3" class="pilcrow">¶</a></p>
<p id="section-6.3-4">Clients may implement "pools" of servers for fail-over or load-balancing.
These pools <span class="bcp14">SHOULD NOT</span> mix RADIUS/UDP and RADIUS/DTLS servers.<span class="cref" id="movetogeneral">This paragraph should probably be moved, as it also applies to RADIUS/TLS. Mixing secure transports with insecure ones is bad practice, regardless of UDP or TCP.<span class="crefSource">Janfred</span></span><a href="#section-6.3-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="session-management">
<section id="section-6.4">
        <h3 id="name-session-management">
<a href="#section-6.4" class="section-number selfRef">6.4. </a><a href="#name-session-management" class="section-name selfRef">Session Management</a>
        </h3>
<p id="section-6.4-1">Where RADIUS/TLS can rely on the TCP state machine to perform session tracking, RADIUS/DTLS cannot.
As a result, implementations of RADIUS/DTLS may need to perform session management of the DTLS session in the application layer.
This subsection describes logically how this tracking is done.
Implementations may choose to use the method described here, or another, equivalent method.<a href="#section-6.4-1" class="pilcrow">¶</a></p>
<p id="section-6.4-2">We note that <span>[<a href="#RFC5080" class="cite xref">RFC5080</a>], <a href="https://rfc-editor.org/rfc/rfc5080#section-2.2.2" class="relref">Section 2.2.2</a></span>, already mandates a duplicate detection cache.
The session tracking described below can be seen as an extension of that cache, where entries contain DTLS sessions instead of RADIUS/UDP packets.<a href="#section-6.4-2" class="pilcrow">¶</a></p>
<p id="section-6.4-3"><span>[<a href="#RFC5080" class="cite xref">RFC5080</a>], <a href="https://rfc-editor.org/rfc/rfc5080#section-2.2.2" class="relref">Section 2.2.2</a></span>, describes how duplicate RADIUS/UDP requests result in the retransmission of a previously cached RADIUS/UDP response.
Due to DTLS sequence window requirements, a server <span class="bcp14">MUST NOT</span> retransmit a previously sent DTLS packet.
Instead, it should cache the RADIUS response packet, and re-process it through DTLS to create a new RADIUS/DTLS packet, every time it is necessary to retransmit a RADIUS response.<a href="#section-6.4-3" class="pilcrow">¶</a></p>
<p id="section-6.4-4"><span class="cref" id="movespecfromclsrvhere">There are some specs (e.g. watchdog, stateless session resumption, closing session if malformed packet or security checks fail) which are valid for both server and client. It might be worth to just move them here instead of having them in both the client and the server spec.<span class="crefSource">Janfred</span></span><a href="#section-6.4-4" class="pilcrow">¶</a></p>
<div id="server-session-management">
<section id="section-6.4.1">
          <h4 id="name-server-session-management">
<a href="#section-6.4.1" class="section-number selfRef">6.4.1. </a><a href="#name-server-session-management" class="section-name selfRef">Server Session Management</a>
          </h4>
<p id="section-6.4.1-1">A RADIUS/DTLS server <span class="bcp14">MUST</span> track ongoing DTLS sessions for each client, based on the following 4-tuple:<a href="#section-6.4.1-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.4.1-2.1">
              <p id="section-6.4.1-2.1.1">source IP address<a href="#section-6.4.1-2.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-6.4.1-2.2">
              <p id="section-6.4.1-2.2.1">source port<a href="#section-6.4.1-2.2.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-6.4.1-2.3">
              <p id="section-6.4.1-2.3.1">destination IP address<a href="#section-6.4.1-2.3.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-6.4.1-2.4">
              <p id="section-6.4.1-2.4.1">destination port<a href="#section-6.4.1-2.4.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-6.4.1-3">Note that this 4-tuple is independent of IP address version (IPv4 or IPv6).<a href="#section-6.4.1-3" class="pilcrow">¶</a></p>
<p id="section-6.4.1-4">Each 4-tuple points to a unique session entry, which usually contains the following information:<a href="#section-6.4.1-4" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-6.4.1-5">
            <dt id="section-6.4.1-5.1">DTLS Session:</dt>
            <dd style="margin-left: 1.5em" id="section-6.4.1-5.2">
              <p id="section-6.4.1-5.2.1">Any information required to maintain and manage the DTLS session.<a href="#section-6.4.1-5.2.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-6.4.1-5.3">Last Traffic:</dt>
            <dd style="margin-left: 1.5em" id="section-6.4.1-5.4">
              <p id="section-6.4.1-5.4.1">A variable containing a timestamp that indicates when this session last received valid traffic.
If "Last Traffic" is not used, this variable may not exist.<a href="#section-6.4.1-5.4.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-6.4.1-5.5">DTLS Data:</dt>
            <dd style="margin-left: 1.5em" id="section-6.4.1-5.6">
              <p id="section-6.4.1-5.6.1">An implementation-specific variable that may contain information about the active DTLS session.
This variable may be empty or nonexistent.<a href="#section-6.4.1-5.6.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-6.4.1-5.7"></dt>
            <dd style="margin-left: 1.5em" id="section-6.4.1-5.8">
              <p id="section-6.4.1-5.8.1">This data will typically contain information such as idle timeouts, session lifetimes, and other implementation-specific data.<a href="#section-6.4.1-5.8.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
</dl>
<div id="session-opening-and-closing">
<section id="section-6.4.1.1">
            <h5 id="name-session-opening-and-closing">
<a href="#section-6.4.1.1" class="section-number selfRef">6.4.1.1. </a><a href="#name-session-opening-and-closing" class="section-name selfRef">Session Opening and Closing</a>
            </h5>
<p id="section-6.4.1.1-1">Session tracking is subject to Denial-of-Service (DoS) attacks due to the ability of an attacker to forge UDP traffic.
RADIUS/DTLS servers <span class="bcp14">SHOULD</span> use the stateless cookie tracking technique described in <span>[<a href="#RFC6347" class="cite xref">RFC6347</a>], <a href="https://rfc-editor.org/rfc/rfc6347#section-4.2.1" class="relref">Section 4.2.1</a></span>.
DTLS sessions <span class="bcp14">SHOULD NOT</span> be tracked until a ClientHello packet has been received with an appropriate Cookie value.
Server implementation <span class="bcp14">SHOULD</span> have a way of tracking DTLS sessions that are partially set up.
Servers <span class="bcp14">MUST</span> limit both the number and impact on resources of partial sessions.<a href="#section-6.4.1.1-1" class="pilcrow">¶</a></p>
<p id="section-6.4.1.1-2">Sessions (both 4-tuple and entry) <span class="bcp14">MUST</span> be deleted when a TLS Closure Alert (<span>[<a href="#RFC5246" class="cite xref">RFC5246</a>], <a href="https://rfc-editor.org/rfc/rfc5246#section-7.2.1" class="relref">Section 7.2.1</a></span>) or a fatal TLS Error Alert (<span>[<a href="#RFC5246" class="cite xref">RFC5246</a>], <a href="https://rfc-editor.org/rfc/rfc5246#section-7.2.2" class="relref">Section 7.2.2</a></span>) is received.<span class="cref" id="closed_for_any_reason">TODO: Suggestion from Alan: "if closed for any reason", but not sure if this is what we mean.<span class="crefSource">Janfred</span></span>
When a session is deleted due to it failing security requirements, the DTLS session <span class="bcp14">MUST</span> be closed, any TLS session resumption parameters for that session <span class="bcp14">MUST</span> be discarded, and all tracking information <span class="bcp14">MUST</span> be deleted.<a href="#section-6.4.1.1-2" class="pilcrow">¶</a></p>
<p id="section-6.4.1.1-3">Sessions <span class="bcp14">MUST</span> also be deleted when a non-RADIUS packet is received over the DTLS connection, a RADIUS packet fails validation due to a packet being malformed, or when it has an invalid Message-Authenticator or invalid Request Authenticator.
There are other cases when the specifications require that a packet received via a DTLS session be "silently discarded".
In those cases, implementations <span class="bcp14">MAY</span> delete the underlying session as described above.
A session <span class="bcp14">SHOULD NOT</span> be deleted when a well-formed, but "unexpected", RADIUS packet is received over it.<a href="#section-6.4.1.1-3" class="pilcrow">¶</a></p>
<p id="section-6.4.1.1-4">These requirements ensure the security while maintaining flexibility.
Any security-related issue causes the connection to be closed.
After security restrictions have been applied, any unexpected traffic may be safely ignored, as it cannot cause a security issue.
This allows for future extensions to the RADIUS/DTLS specifications.<a href="#section-6.4.1.1-4" class="pilcrow">¶</a></p>
<p id="section-6.4.1.1-5">As UDP does not guarantee delivery of messages, RADIUS/DTLS servers <span class="bcp14">MUST</span> maintain a "Last Traffic" timestamp per DTLS session.
The granularity of this timestamp is not critical and could be limited to one-second intervals.
The timestamp <span class="bcp14">SHOULD</span> be updated on reception of a valid RADIUS/DTLS packet, or a DTLS Heartbeat, but no more than once per interval.
The timestamp <span class="bcp14">MUST NOT</span> be updated in other situations, such as when packets are "silently discarded".<a href="#section-6.4.1.1-5" class="pilcrow">¶</a></p>
<p id="section-6.4.1.1-6">RADIUS/DTLS servers <span class="bcp14">SHOULD</span> implement session resumption, preferably stateless session resumption as given in <span>[<a href="#RFC5077" class="cite xref">RFC5077</a>]</span>.
This practice lowers the time and effort required to start a DTLS session with a client and increases network responsiveness.<a href="#section-6.4.1.1-6" class="pilcrow">¶</a></p>
<p id="section-6.4.1.1-7">Since UDP is stateless, the potential exists for the client to initiate a new DTLS session using a particular 4-tuple, before the server has closed the old session.
For security reasons, the server <span class="bcp14">MUST</span> keep the old session active until either it has received secure notification from the client that the session is closed or the server decides to close the session based on idle timeouts.
Taking any other action would permit unauthenticated clients to perform a DoS attack, by reusing a 4-tuple and thus causing the server to close an active (and authenticated) DTLS session.<a href="#section-6.4.1.1-7" class="pilcrow">¶</a></p>
<p id="section-6.4.1.1-8">As a result, servers <span class="bcp14">MUST</span> ignore any attempts to reuse an existing 4-tuple from an active session.
This requirement can likely be reached by simply processing the packet through the existing session, as with any other packet received via that 4-tuple.
Non-compliant, or unexpected packets will be ignored by the DTLS layer.<span class="cref" id="proxymitigation">In RFC7360 there is a final paragraph about mitigation of the 4-tuple problem by using a local proxy. I'm not sure if this is the right place here, i'd rather move that to a general "Implementation Guidelines" paragraph.<span class="crefSource">Janfred</span></span><a href="#section-6.4.1.1-8" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="client-session-management">
<section id="section-6.4.2">
          <h4 id="name-client-session-management">
<a href="#section-6.4.2" class="section-number selfRef">6.4.2. </a><a href="#name-client-session-management" class="section-name selfRef">Client Session Management</a>
          </h4>
<p id="section-6.4.2-1">RADIUS/DTLS clients <span class="bcp14">SHOULD</span> use PMTU discovery <span>[<a href="#RFC6520" class="cite xref">RFC6520</a>]</span> to determine the PMTU between the client and server, prior to sending any RADIUS traffic.<a href="#section-6.4.2-1" class="pilcrow">¶</a></p>
<p id="section-6.4.2-2">DTLS sessions <span class="bcp14">MUST</span> be deleted when a RADIUS packet fails validation due to a packet being malformed, or when it has an invalid Message-Authenticator or invalid Response Authenticator.<span class="cref" id="normalizespec">Maybe modify this text to be more similar to the TLS specific text here.<span class="crefSource">Janfred</span></span><a href="#section-6.4.2-2" class="pilcrow">¶</a></p>
<p id="section-6.4.2-3">There are other cases, when the specifications require that a packet received via a DTLS session be "silently discarded".
In those cases, implementations <span class="bcp14">MAY</span> delete the underlying DTLS session.<a href="#section-6.4.2-3" class="pilcrow">¶</a></p>
<p id="section-6.4.2-4">RADIUS/DTLS clients <span class="bcp14">SHOULD NOT</span> send both RADIUS/UDP and RADIUS/DTLS packets to different servers from the same source socket.
This practice causes increased complexity in the client application and increases the potential for security breaches due to implementation issues.<a href="#section-6.4.2-4" class="pilcrow">¶</a></p>
<p id="section-6.4.2-5">RADIUS/DTLS clients <span class="bcp14">SHOULD</span> implement session resumption, preferably stateless session resumption as given in <span>[<a href="#RFC5077" class="cite xref">RFC5077</a>]</span>.
This practice lowers the time and effort required to start a DTLS session with a server and increases network responsiveness.<a href="#section-6.4.2-5" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="security_considerations">
<section id="section-7">
      <h2 id="name-security-considerations">
<a href="#section-7" class="section-number selfRef">7. </a><a href="#name-security-considerations" class="section-name selfRef">Security Considerations</a>
      </h2>
<p id="section-7-1">As this specification relies on the existing TLS and DTLS specifications, all security considerations for these protocols also apply to the (D)TLS portions of RADIUS/(D)TLS.<a href="#section-7-1" class="pilcrow">¶</a></p>
<p id="section-7-2">For RADIUS however, many security considerations raised in the RADIUS documents are related to RADIUS encryption and authorization.
Those issues are largely mitigated when (D)TLS is used as a transport method, since encryption and authorization is achieved on the (D)TLS layer.
The issues that are not mitigated by this specification are related to the RADIUS packet format and handling, which is unchanged in this specification.<a href="#section-7-2" class="pilcrow">¶</a></p>
<p id="section-7-3">A few remaining security considerations and notes to administrators deploying RADIUS/(D)TLS are listed below.<a href="#section-7-3" class="pilcrow">¶</a></p>
<div id="radius-proxies">
<section id="section-7.1">
        <h3 id="name-radius-proxies">
<a href="#section-7.1" class="section-number selfRef">7.1. </a><a href="#name-radius-proxies" class="section-name selfRef">RADIUS Proxies</a>
        </h3>
<p id="section-7.1-1">RADIUS/(D)TLS provides authentication, integrity and confidentiality protection for RADIUS traffic between two RADIUS peers.
In the presence of proxies, these intermediate proxies can still inspect the individual RADIUS packets, i.e., "end-to-end" encryption on the RADIUS layer is not provided.
Where intermediate proxies are untrusted, it is desirable to use other RADIUS mechanisms to prevent RADIUS packet payload from inspection by such proxies.
One common method to protect passwords is the use of the Extensible Authentication Protocol (EAP) and EAP methods that utilize TLS.<a href="#section-7.1-1" class="pilcrow">¶</a></p>
<p id="section-7.1-2">Additionally, when RADIUS proxies are used, the RADIUS client has no way of ensuring that the complete path of the RADIUS packet is protected, since RADIUS routing is done hop-by-hop and any intermediate proxy may be configured, after receiving a RADIUS packet via RADIUS/(D)TLS from one peer, to forward this packet to a different peer using the RADIUS/UDP transport profile.
There is no technical solution to this problem with the current specification.
Where the confidentiality of the contents of the RADIUS packet across the whole path is required, organizational solutions need to be in place, that ensure that every intermediate RADIUS proxy is configured to forward the RADIUS packets using RADIUS/(D)TLS as transport.<a href="#section-7.1-2" class="pilcrow">¶</a></p>
<p id="section-7.1-3"><span class="cref" id="refto7585">TODO: Mabe add a reference to handling dynamic discovery (RFC7585) here too, and (as per Alans comments) that this issue is best resolved by limiting use of proxies.<span class="crefSource">Janfred</span></span><a href="#section-7.1-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="usage-of-null-encryption-cipher-suites-for-debugging">
<section id="section-7.2">
        <h3 id="name-usage-of-null-encryption-ci">
<a href="#section-7.2" class="section-number selfRef">7.2. </a><a href="#name-usage-of-null-encryption-ci" class="section-name selfRef">Usage of null encryption cipher suites for debugging</a>
        </h3>
<p id="section-7.2-1">For debugging purposes, some TLS implementations offer cipher suites with NULL encryption, to allow inspection of the plaintext with packet sniffing tools.
Since with RADIUS/(D)TLS the RADIUS shared secret is set to a static string ("radsec" for RADIUS/TLS, "radius/dtls" for RADIUS/DTLS), using a NULL encryption cipher suite will also result in complete disclosure of the whole RADIUS packet, including the encrypted RADIUS attributes, to any party eavesdropping on the conversation.
Following the recommendations in <span>[<a href="#RFC9325" class="cite xref">RFC9325</a>], <a href="https://rfc-editor.org/rfc/rfc9325#section-4.1" class="relref">Section 4.1</a></span>, this specification forbids the usage of NULL encryption cipher suites for RADIUS/(D)TLS.<a href="#section-7.2-1" class="pilcrow">¶</a></p>
<p id="section-7.2-2">For cases where administrators need access to the decrypted RADIUS/(D)TLS traffic, we suggest using different approaches, like exporting the key material from TLS libraries according to <span>[<a href="#I-D.ietf-tls-keylogfile" class="cite xref">I-D.ietf-tls-keylogfile</a>]</span>.<a href="#section-7.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="possibility-of-denial-of-service-attacks">
<section id="section-7.3">
        <h3 id="name-possibility-of-denial-of-se">
<a href="#section-7.3" class="section-number selfRef">7.3. </a><a href="#name-possibility-of-denial-of-se" class="section-name selfRef">Possibility of Denial-of-Service attacks</a>
        </h3>
<p id="section-7.3-1">Both RADIUS/TLS and RADIUS/DTLS have a considerable higher amount of data that the server needs to store in comparison to RADIUS/UDP.
Therefore, an attacker could try to exhaust server resources.<a href="#section-7.3-1" class="pilcrow">¶</a></p>
<p id="section-7.3-2">With RADIUS/UDP, any bogus RADIUS packet would fail the cryptographic checks and the server would silently discard the bogus packet.
For RADIUS/(D)TLS, the server needs to perform at least a partial TLS handshake to determine whether or not the client is authorized.
Performing a (D)TLS handshake is more complex than the cryptographic check of a RADIUS packet.
An attacker could try to trigger a high number of (D)TLS handshakes at the same time, resulting in a high server load and potentially a Denial-of-Service.
To prevent this attack, a RADIUS/(D)TLS server <span class="bcp14">SHOULD</span> have configurable limits on new connection attempts.<a href="#section-7.3-2" class="pilcrow">¶</a></p>
<p id="section-7.3-3">Both TLS and DTLS need to store session information for each open (D)TLS session.
Especially with DTLS, a bogus or misbehaving client could open an excessive number of DTLS sessions.
This session tracking could lead to a resource exhaustion on the server side, triggering a Denial-of-Service.
Therefore, RADIUS/(D)TLS servers <span class="bcp14">MUST</span> limit the absolute number of sessions they can track and <span class="bcp14">SHOULD</span> expose this limit as configurable option to the administrator.
When the total number of sessions tracked is going to exceed the configured limit, servers <span class="bcp14">MAY</span> free up resources by closing the session that has been idle for the longest time.
Doing so may free up idle resources that then allow the server to accept a new session.<a href="#section-7.3-3" class="pilcrow">¶</a></p>
<p id="section-7.3-4">RADIUS/DTLS servers <span class="bcp14">MUST</span> limit the number of partially open DTLS sessions and <span class="bcp14">SHOULD</span> expose this limit as configurable option to the administrator.<a href="#section-7.3-4" class="pilcrow">¶</a></p>
<p id="section-7.3-5">To prevent resource exhaustion by partially opening a large number of DTLS sessions, RADIUS/DTLS servers <span class="bcp14">SHOULD</span> have a timeout on partially open DTLS sessions.
We recommend a limit of a few seconds, implementations <span class="bcp14">SHOULD</span> expose this timeout as configurable option to the administrator.
If a DTLS session is not established within this timeframe, it is likely that this is a bogus connection.
In contrast, an established session might not send packets for longer periods of time, but since the peers are mutually authenticated this does not pose a problem other than the problems mentioned before.<a href="#section-7.3-5" class="pilcrow">¶</a></p>
<p id="section-7.3-6">A different means of prevention is IP filtering.
If the IP range that the server expects clients to connect from is restricted, then the server can simply reject or drop all connection attempts from outside those ranges.
If every RADIUS/(D)TLS client is configured with an IP range, then the server does not even have to perform a partial TLS handshake if the connection attempt comes from outside every allowed range, but can instead immediately drop the connection.
To perform this lookup efficiently, RADIUS/(D)TLS servers <span class="bcp14">SHOULD</span> keep a list of the cumulated permitted IP ranges, individually for each transport.<a href="#section-7.3-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="session-closing">
<section id="section-7.4">
        <h3 id="name-session-closing">
<a href="#section-7.4" class="section-number selfRef">7.4. </a><a href="#name-session-closing" class="section-name selfRef">Session Closing</a>
        </h3>
<p id="section-7.4-1">If malformed RADIUS packets are received or the packets fail the authenticator checks, this specification requires that the (D)TLS session be closed.
The reason is that the session is expected to be used for transport of RADIUS packets only.<a href="#section-7.4-1" class="pilcrow">¶</a></p>
<p id="section-7.4-2">Any non-RADIUS traffic on that session means the other party is misbehaving and is potentially a security risk.
Similarly, any RADIUS traffic failing authentication vector or Message-Authenticator validation means that two parties do not have a common shared secret.
Since the shared secret is static, this again means the other party is misbehaving.<a href="#section-7.4-2" class="pilcrow">¶</a></p>
<p id="section-7.4-3">We wish to avoid the situation where a third party can send well-formed RADIUS packets to a RADIUS proxy that cause a (D)TLS session to close.
Therefore, in other situations, the session <span class="bcp14">SHOULD</span> remain open in the face of non-conforming packets.
Any malformed RADIUS packets sent by a third party will go through the security checks of the RADIUS proxy upon reception and will not be forwarded.
Well-formed RADIUS packets with portions that the proxy does not understand do not pose a security risk to the security properties of the RADIUS/(D)TLS session and can be forwarded.
This ensures forward compatibility with future RADIUS extensions.<a href="#section-7.4-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="migrating-from-radiusudp-to-radiusdtls">
<section id="section-7.5">
        <h3 id="name-migrating-from-radius-udp-t">
<a href="#section-7.5" class="section-number selfRef">7.5. </a><a href="#name-migrating-from-radius-udp-t" class="section-name selfRef">Migrating from RADIUS/UDP to RADIUS/(D)TLS</a>
        </h3>
<p id="section-7.5-1">Since RADIUS/UDP security relies on the MD5 algorithm, which is considered insecure, using RADIUS/UDP over insecure networks is risky.
We therefore recommend to migrate from RADIUS/UDP to RADIUS/(D)TLS.
Within this migration process, however, there are a few items that need to be considered by administrators.<a href="#section-7.5-1" class="pilcrow">¶</a></p>
<p id="section-7.5-2">Firstly, administrators may be tempted to simply migrate from RADIUS/UDP to RADIUS/(D)TLS with (D)TLS-PSK and reuse the RADIUS shared secret as (D)TLS-PSK.
While this may seem like an easy way to upgrade RADIUS/UDP to RADIUS/(D)TLS, the cryptographic problems with the RADIUS/UDP shared secret render the shared secret potentially compromised.
Using a potentially compromised shared secret as TLS-PSK compromises the whole TLS connection.
Therefore, any shared secret used with RADIUS/UDP before <span class="bcp14">MUST NOT</span> be used with RADIUS/(D)TLS and (D)TLS-PSK.
Implementers <span class="bcp14">MUST NOT</span> reuse the configuration option for the RADIUS/UDP shared secret for the (D)TLS-PSK to prevent accidental reuse.<a href="#section-7.5-2" class="pilcrow">¶</a></p>
<p id="section-7.5-3">When upgrading from RADIUS/UDP to RADIUS/(D)TLS, there may be a period of time, where the connection between client and server is configured for both transport profiles.
If the old RADIUS/UDP configuration is left configured, but not used in normal operation, e.g. due to a fail-over configuration that prefers RADIUS/(D)TLS, an attacker could disrupt the RADIUS/(D)TLS communication and force a downgrade to RADIUS/UDP.
To prevent this it is <span class="bcp14">RECOMMENDED</span> that, when the migration to RADIUS/(D)TLS is completed, the RADIUS/UDP configuration is removed.
RADIUS/(D)TLS clients <span class="bcp14">MUST NOT</span> fall back to RADIUS/UDP if the RADIUS/(D)TLS communication fails, unless explicitly configured this way.<a href="#section-7.5-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="client-subsystems">
<section id="section-7.6">
        <h3 id="name-client-subsystems">
<a href="#section-7.6" class="section-number selfRef">7.6. </a><a href="#name-client-subsystems" class="section-name selfRef">Client Subsystems</a>
        </h3>
<p id="section-7.6-1">Many traditional clients treat RADIUS as subsystem-specific.
That is, each subsystem on the client has its own RADIUS implementation and configuration.
These independent implementations work for simple systems, but break down for RADIUS when multiple servers, fail-over and load-balancing are required.
With (D)TLS enabled, these problems are expected to get worse.<a href="#section-7.6-1" class="pilcrow">¶</a></p>
<p id="section-7.6-2">We therefore recommend in these situations to use a local proxy that arbitrates all RADIUS traffic between the client and all servers.
This proxy will encapsulate all knowledge about servers, including security policies, fail-over and load-balancing.
All client subsystems should communicate with this local proxy, ideally over a loopback address.<a href="#section-7.6-2" class="pilcrow">¶</a></p>
<p id="section-7.6-3">The benefit of this configuration is that there is one place in the client that arbitrates all RADIUS traffic.
Subsystems that do not implement RADIUS/(D)TLS can remain unaware of (D)TLS.
(D)TLS sessions opened by the proxy can remain open for a long period of time, even when client subsystems are restarted.
The proxy can do RADIUS/UDP to some servers and RADIUS/(D)TLS to others.<a href="#section-7.6-3" class="pilcrow">¶</a></p>
<p id="section-7.6-4">Delegation of responsibilities and separation of tasks are important security principles.
By moving all RADIUS/(D)TLS knowledge to a (D)TLS-aware proxy, security analysis becomes simpler, and enforcement of correct security becomes easier.<a href="#section-7.6-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="loopback-attack-on-peers-acting-as-server-and-client">
<section id="section-7.7">
        <h3 id="name-loopback-attack-on-peers-ac">
<a href="#section-7.7" class="section-number selfRef">7.7. </a><a href="#name-loopback-attack-on-peers-ac" class="section-name selfRef">Loopback-Attack on Peers acting as Server and Client</a>
        </h3>
<p id="section-7.7-1">TODO<a href="#section-7.7-1" class="pilcrow">¶</a></p>
<p id="section-7.7-2">Rough problem description to visualize the problem for others.
Will be removed and replaced with text explaining the issue and possible mitigations:<a href="#section-7.7-2" class="pilcrow">¶</a></p>
<p id="section-7.7-3">Preconditions:<a href="#section-7.7-3" class="pilcrow">¶</a></p>
<p id="section-7.7-4">Peer A is configured with a client certificate for sending packets via dynamic discovery.
The certificate has a specific OID indicating it as a "roaming consortium client" certificate.
The configuration expects a server certificate from the server with an OID for a "roaming consortium server" certificate and does not perform more checks apart from the trust chain checks.<a href="#section-7.7-4" class="pilcrow">¶</a></p>
<p id="section-7.7-5">Peer A is also configured with a server certificate for receiving packets via dynamic discovery.
The server certificate has a specific OID indicating it as a "roaming consortium server" certificate.
The configuration expects a client certificate from the client with an OID for a "roaming consortium client" certificate and does not perform more checks apart from the trust chain checks.<a href="#section-7.7-5" class="pilcrow">¶</a></p>
<p id="section-7.7-6">For the sake of this example we can say that both certificates come from the same CA and that this CA is marked as trusted.<a href="#section-7.7-6" class="pilcrow">¶</a></p>
<p id="section-7.7-7">Attack:<a href="#section-7.7-7" class="pilcrow">¶</a></p>
<p id="section-7.7-8">Peer A (as Client A) tries to open RADIUS/TLS connection to Server B.
The attacker intercepts the connection and mirrors it back to A (now acting as Server A)
Server A sends the server certificate with the server OID.
Client A receives it, accepts it, since it sees the server OID and sends the client certificate.
Server A receives it and also accepts it, since it sees the client OID.<a href="#section-7.7-8" class="pilcrow">¶</a></p>
<p id="section-7.7-9">Now Peer A has a loop.
Client A sends packets, believing they are sent to the right home server.
Server A receives packets from a valid-looking client and forwards them, since it is not responsible for the realm.
Now every packet is stuck in an endless-loop and the attacker just has to bounce the traffic back-and-forth, possibly leading to a complete denial-of-service.<a href="#section-7.7-9" class="pilcrow">¶</a></p>
<p id="section-7.7-10">Ideas for solutions:<a href="#section-7.7-10" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-7.7-11.1">
            <p id="section-7.7-11.1.1">Don't accept your own certificate.<a href="#section-7.7-11.1.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-7.7-11.1.2.1">
                <p id="section-7.7-11.1.2.1.1">May not be what you want.<a href="#section-7.7-11.1.2.1.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li class="normal" id="section-7.7-11.2">
            <p id="section-7.7-11.2.1">Remember the client random and compare the server random<a href="#section-7.7-11.2.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-7.7-11.2.2.1">
                <p id="section-7.7-11.2.2.1.1">May still not be good enough. Depending on the implementation could lead to different race conditions being triggered.<a href="#section-7.7-11.2.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-7.7-11.2.2.2">
                <p id="section-7.7-11.2.2.2.1">Maybe not all TLS implementations allow you to get the client random?<a href="#section-7.7-11.2.2.2.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li class="normal" id="section-7.7-11.3">
            <p id="section-7.7-11.3.1">Send a randomized number in the TLS client hello<a href="#section-7.7-11.3.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-7.7-11.3.2.1">
                <p id="section-7.7-11.3.2.1.1">Number could be generated at startup (or even changed once in a while). Every outgoing TLS has this in the client hello, the server can check if the "ID" number of the other end is the same to its own. If it is: Drop the connection.<a href="#section-7.7-11.3.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-7.7-11.3.2.2">
                <p id="section-7.7-11.3.2.2.1">But needs a TLS extension (or some other smart way of doing this with the tools available)<a href="#section-7.7-11.3.2.2.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
        </ul>
</section>
</div>
</section>
</div>
<div id="design_decisions">
<section id="section-8">
      <h2 id="name-design-decisions">
<a href="#section-8" class="section-number selfRef">8. </a><a href="#name-design-decisions" class="section-name selfRef">Design Decisions</a>
      </h2>
<p id="section-8-1">Many of the design decisions of RADIUS/TLS and RADIUS/DTLS can be found in <span>[<a href="#RFC6614" class="cite xref">RFC6614</a>]</span> and <span>[<a href="#RFC7360" class="cite xref">RFC7360</a>]</span>.
This section will discuss the rationale behind significant changes from the experimental specification.<a href="#section-8-1" class="pilcrow">¶</a></p>
<div id="design_supported_transports">
<section id="section-8.1">
        <h3 id="name-mandatory-to-implement-tran">
<a href="#section-8.1" class="section-number selfRef">8.1. </a><a href="#name-mandatory-to-implement-tran" class="section-name selfRef">Mandatory-to-implement transports</a>
        </h3>
<p id="section-8.1-1">With the merging of RADIUS/TLS and RADIUS/DTLS the question of mandatory-to-implement transports arose.
In order to avoid incompatibilities, there were two possibilities: Either mandate one of the transports for all implementations or mandate the implementation of both transports for either the server or the client.
As of the time writing, RADIUS/TLS is widely adapted for some use cases (see <a href="#lessons_learned" class="auto internal xref">Appendix A</a>).
However, TLS has some serious drawbacks when used for RADIUS transport.
Especially the sequential nature of the connection and the connected issues like Head-of-Line blocking could create problems.<a href="#section-8.1-1" class="pilcrow">¶</a></p>
<p id="section-8.1-2">Therefore, the decision was made that RADIUS servers must implement both transports.
For RADIUS clients, that may run on more constrained nodes, the implementations can choose to implement only the transport, that is better suited for their needs.<a href="#section-8.1-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="design_trust_profiles">
<section id="section-8.2">
        <h3 id="name-mandatory-to-implement-trus">
<a href="#section-8.2" class="section-number selfRef">8.2. </a><a href="#name-mandatory-to-implement-trus" class="section-name selfRef">Mandatory-to-implement trust profiles</a>
        </h3>
<p id="section-8.2-1"><span>[<a href="#RFC6614" class="cite xref">RFC6614</a>]</span> mandates the implementation of the trust profile "certificate with PKIX trust model" for both clients and servers.
The experience of the deployment of RADIUS/TLS as specified in <span>[<a href="#RFC6614" class="cite xref">RFC6614</a>]</span> has shown that most actors still rely on RADIUS/UDP.
Since dealing with certificates can create a lot of issues, both for implementers and administrators, for the re-specification we wanted to create an alternative to insecure RADIUS transports like RADIUS/UDP that can be deployed easily without much additional administrative overhead.<a href="#section-8.2-1" class="pilcrow">¶</a></p>
<p id="section-8.2-2">As with the supported transports, the assumption is that RADIUS servers are generally believed to be less constrained than RADIUS clients.
Since some client implementations already support using certificates for mutual authentication and there are several use cases, where pre-shared keys are not usable (e.g. a dynamic federation with changing members), the decision was made that, analog to the supported transports, RADIUS servers must implement both certificates with PKIX trust model and TLS-PSK as means of mutual authentication.
RADIUS clients again can choose which method is better suited for them, but must, for compatibility reasons, implement at least one of the two.<a href="#section-8.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="design_changes_in_tls">
<section id="section-8.3">
        <h3 id="name-changes-in-application-of-t">
<a href="#section-8.3" class="section-number selfRef">8.3. </a><a href="#name-changes-in-application-of-t" class="section-name selfRef">Changes in application of TLS</a>
        </h3>
<p id="section-8.3-1">The original specification of RADIUS/TLS does not forbid the usage of compression in the TLS layer.
As per <span>[<a href="#RFC9325" class="cite xref">RFC9325</a>], <a href="https://rfc-editor.org/rfc/rfc9325#section-3.3" class="relref">Section 3.3</a></span>, compression should not be used due to the possibility of compression-related attacks, unless the application protocol is proven to be not open to such attacks.
Since some attributes of the RADIUS packets within the TLS tunnel contain values that an attacker could at least partially choose (i.e. username, MAC address or EAP message), there is a possibility for compression-related attacks, that could potentially reveal data in other RADIUS attributes through length of the TLS record.
To circumvent this attack, this specification forbids the usage of TLS compression.<a href="#section-8.3-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="iana-considerations">
<section id="section-9">
      <h2 id="name-iana-considerations">
<a href="#section-9" class="section-number selfRef">9. </a><a href="#name-iana-considerations" class="section-name selfRef">IANA Considerations</a>
      </h2>
<p id="section-9-1">Upon approval, IANA should update the Reference to radsec in the Service Name and Transport Protocol Port Number Registry:<a href="#section-9-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-9-2.1">
          <p id="section-9-2.1.1">Service Name: radsec<a href="#section-9-2.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-9-2.2">
          <p id="section-9-2.2.1">Port Number: 2083<a href="#section-9-2.2.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-9-2.3">
          <p id="section-9-2.3.1">Transport Protocol: tcp/udp<a href="#section-9-2.3.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-9-2.4">
          <p id="section-9-2.4.1">Description: Secure RADIUS Service<a href="#section-9-2.4.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-9-2.5">
          <p id="section-9-2.5.1">Assignment notes: The TCP port 2083 was already previously assigned by IANA for "RadSec", an early implementation of RADIUS/TLS, prior to issuance of the experimental RFC 6614.
[RFCXXXX] updates RFC 6614 (RADIUS/TLS) and RFC 7360 (RADIUS/DTLS), while maintaining backward compatibility, if configured. For further details see RFC 6614, Appendix A or [RFCXXXX] <a href="#backwardcomp" class="auto internal xref">Appendix C</a>.<a href="#section-9-2.5.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-9-2.6">
          <p id="section-9-2.6.1">Reference: [RFCXXXX] (this document)<a href="#section-9-2.6.1" class="pilcrow">¶</a></p>
</li>
      </ul>
</section>
</div>
<div id="sec-combined-references">
<section id="section-10">
      <h2 id="name-references">
<a href="#section-10" class="section-number selfRef">10. </a><a href="#name-references" class="section-name selfRef">References</a>
      </h2>
<div id="sec-normative-references">
<section id="section-10.1">
        <h3 id="name-normative-references">
<a href="#section-10.1" class="section-number selfRef">10.1. </a><a href="#name-normative-references" class="section-name selfRef">Normative References</a>
        </h3>
<dl class="references">
<dt id="RFC2119">[RFC2119]</dt>
        <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time datetime="1997-03" class="refDate">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc2119">https://www.rfc-editor.org/rfc/rfc2119</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2865">[RFC2865]</dt>
        <dd>
<span class="refAuthor">Rigney, C.</span>, <span class="refAuthor">Willens, S.</span>, <span class="refAuthor">Rubens, A.</span>, and <span class="refAuthor">W. Simpson</span>, <span class="refTitle">"Remote Authentication Dial In User Service (RADIUS)"</span>, <span class="seriesInfo">RFC 2865</span>, <span class="seriesInfo">DOI 10.17487/RFC2865</span>, <time datetime="2000-06" class="refDate">June 2000</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc2865">https://www.rfc-editor.org/rfc/rfc2865</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2866">[RFC2866]</dt>
        <dd>
<span class="refAuthor">Rigney, C.</span>, <span class="refTitle">"RADIUS Accounting"</span>, <span class="seriesInfo">RFC 2866</span>, <span class="seriesInfo">DOI 10.17487/RFC2866</span>, <time datetime="2000-06" class="refDate">June 2000</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc2866">https://www.rfc-editor.org/rfc/rfc2866</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC3539">[RFC3539]</dt>
        <dd>
<span class="refAuthor">Aboba, B.</span> and <span class="refAuthor">J. Wood</span>, <span class="refTitle">"Authentication, Authorization and Accounting (AAA) Transport Profile"</span>, <span class="seriesInfo">RFC 3539</span>, <span class="seriesInfo">DOI 10.17487/RFC3539</span>, <time datetime="2003-06" class="refDate">June 2003</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc3539">https://www.rfc-editor.org/rfc/rfc3539</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC3579">[RFC3579]</dt>
        <dd>
<span class="refAuthor">Aboba, B.</span> and <span class="refAuthor">P. Calhoun</span>, <span class="refTitle">"RADIUS (Remote Authentication Dial In User Service) Support For Extensible Authentication Protocol (EAP)"</span>, <span class="seriesInfo">RFC 3579</span>, <span class="seriesInfo">DOI 10.17487/RFC3579</span>, <time datetime="2003-09" class="refDate">September 2003</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc3579">https://www.rfc-editor.org/rfc/rfc3579</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4033">[RFC4033]</dt>
        <dd>
<span class="refAuthor">Arends, R.</span>, <span class="refAuthor">Austein, R.</span>, <span class="refAuthor">Larson, M.</span>, <span class="refAuthor">Massey, D.</span>, and <span class="refAuthor">S. Rose</span>, <span class="refTitle">"DNS Security Introduction and Requirements"</span>, <span class="seriesInfo">RFC 4033</span>, <span class="seriesInfo">DOI 10.17487/RFC4033</span>, <time datetime="2005-03" class="refDate">March 2005</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc4033">https://www.rfc-editor.org/rfc/rfc4033</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5077">[RFC5077]</dt>
        <dd>
<span class="refAuthor">Salowey, J.</span>, <span class="refAuthor">Zhou, H.</span>, <span class="refAuthor">Eronen, P.</span>, and <span class="refAuthor">H. Tschofenig</span>, <span class="refTitle">"Transport Layer Security (TLS) Session Resumption without Server-Side State"</span>, <span class="seriesInfo">RFC 5077</span>, <span class="seriesInfo">DOI 10.17487/RFC5077</span>, <time datetime="2008-01" class="refDate">January 2008</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc5077">https://www.rfc-editor.org/rfc/rfc5077</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5080">[RFC5080]</dt>
        <dd>
<span class="refAuthor">Nelson, D.</span> and <span class="refAuthor">A. DeKok</span>, <span class="refTitle">"Common Remote Authentication Dial In User Service (RADIUS) Implementation Issues and Suggested Fixes"</span>, <span class="seriesInfo">RFC 5080</span>, <span class="seriesInfo">DOI 10.17487/RFC5080</span>, <time datetime="2007-12" class="refDate">December 2007</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc5080">https://www.rfc-editor.org/rfc/rfc5080</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5176">[RFC5176]</dt>
        <dd>
<span class="refAuthor">Chiba, M.</span>, <span class="refAuthor">Dommety, G.</span>, <span class="refAuthor">Eklund, M.</span>, <span class="refAuthor">Mitton, D.</span>, and <span class="refAuthor">B. Aboba</span>, <span class="refTitle">"Dynamic Authorization Extensions to Remote Authentication Dial In User Service (RADIUS)"</span>, <span class="seriesInfo">RFC 5176</span>, <span class="seriesInfo">DOI 10.17487/RFC5176</span>, <time datetime="2008-01" class="refDate">January 2008</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc5176">https://www.rfc-editor.org/rfc/rfc5176</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5246">[RFC5246]</dt>
        <dd>
<span class="refAuthor">Dierks, T.</span> and <span class="refAuthor">E. Rescorla</span>, <span class="refTitle">"The Transport Layer Security (TLS) Protocol Version 1.2"</span>, <span class="seriesInfo">RFC 5246</span>, <span class="seriesInfo">DOI 10.17487/RFC5246</span>, <time datetime="2008-08" class="refDate">August 2008</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc5246">https://www.rfc-editor.org/rfc/rfc5246</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5247">[RFC5247]</dt>
        <dd>
<span class="refAuthor">Aboba, B.</span>, <span class="refAuthor">Simon, D.</span>, and <span class="refAuthor">P. Eronen</span>, <span class="refTitle">"Extensible Authentication Protocol (EAP) Key Management Framework"</span>, <span class="seriesInfo">RFC 5247</span>, <span class="seriesInfo">DOI 10.17487/RFC5247</span>, <time datetime="2008-08" class="refDate">August 2008</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc5247">https://www.rfc-editor.org/rfc/rfc5247</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5248">[RFC5248]</dt>
        <dd>
<span class="refAuthor">Hansen, T.</span> and <span class="refAuthor">J. Klensin</span>, <span class="refTitle">"A Registry for SMTP Enhanced Mail System Status Codes"</span>, <span class="seriesInfo">BCP 138</span>, <span class="seriesInfo">RFC 5248</span>, <span class="seriesInfo">DOI 10.17487/RFC5248</span>, <time datetime="2008-06" class="refDate">June 2008</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc5248">https://www.rfc-editor.org/rfc/rfc5248</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5280">[RFC5280]</dt>
        <dd>
<span class="refAuthor">Cooper, D.</span>, <span class="refAuthor">Santesson, S.</span>, <span class="refAuthor">Farrell, S.</span>, <span class="refAuthor">Boeyen, S.</span>, <span class="refAuthor">Housley, R.</span>, and <span class="refAuthor">W. Polk</span>, <span class="refTitle">"Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile"</span>, <span class="seriesInfo">RFC 5280</span>, <span class="seriesInfo">DOI 10.17487/RFC5280</span>, <time datetime="2008-05" class="refDate">May 2008</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc5280">https://www.rfc-editor.org/rfc/rfc5280</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5997">[RFC5997]</dt>
        <dd>
<span class="refAuthor">DeKok, A.</span>, <span class="refTitle">"Use of Status-Server Packets in the Remote Authentication Dial In User Service (RADIUS) Protocol"</span>, <span class="seriesInfo">RFC 5997</span>, <span class="seriesInfo">DOI 10.17487/RFC5997</span>, <time datetime="2010-08" class="refDate">August 2010</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc5997">https://www.rfc-editor.org/rfc/rfc5997</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6066">[RFC6066]</dt>
        <dd>
<span class="refAuthor">Eastlake 3rd, D.</span>, <span class="refTitle">"Transport Layer Security (TLS) Extensions: Extension Definitions"</span>, <span class="seriesInfo">RFC 6066</span>, <span class="seriesInfo">DOI 10.17487/RFC6066</span>, <time datetime="2011-01" class="refDate">January 2011</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc6066">https://www.rfc-editor.org/rfc/rfc6066</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6347">[RFC6347]</dt>
        <dd>
<span class="refAuthor">Rescorla, E.</span> and <span class="refAuthor">N. Modadugu</span>, <span class="refTitle">"Datagram Transport Layer Security Version 1.2"</span>, <span class="seriesInfo">RFC 6347</span>, <span class="seriesInfo">DOI 10.17487/RFC6347</span>, <time datetime="2012-01" class="refDate">January 2012</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc6347">https://www.rfc-editor.org/rfc/rfc6347</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6520">[RFC6520]</dt>
        <dd>
<span class="refAuthor">Seggelmann, R.</span>, <span class="refAuthor">Tuexen, M.</span>, and <span class="refAuthor">M. Williams</span>, <span class="refTitle">"Transport Layer Security (TLS) and Datagram Transport Layer Security (DTLS) Heartbeat Extension"</span>, <span class="seriesInfo">RFC 6520</span>, <span class="seriesInfo">DOI 10.17487/RFC6520</span>, <time datetime="2012-02" class="refDate">February 2012</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc6520">https://www.rfc-editor.org/rfc/rfc6520</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7250">[RFC7250]</dt>
        <dd>
<span class="refAuthor">Wouters, P., Ed.</span>, <span class="refAuthor">Tschofenig, H., Ed.</span>, <span class="refAuthor">Gilmore, J.</span>, <span class="refAuthor">Weiler, S.</span>, and <span class="refAuthor">T. Kivinen</span>, <span class="refTitle">"Using Raw Public Keys in Transport Layer Security (TLS) and Datagram Transport Layer Security (DTLS)"</span>, <span class="seriesInfo">RFC 7250</span>, <span class="seriesInfo">DOI 10.17487/RFC7250</span>, <time datetime="2014-06" class="refDate">June 2014</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc7250">https://www.rfc-editor.org/rfc/rfc7250</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7585">[RFC7585]</dt>
        <dd>
<span class="refAuthor">Winter, S.</span> and <span class="refAuthor">M. McCauley</span>, <span class="refTitle">"Dynamic Peer Discovery for RADIUS/TLS and RADIUS/DTLS Based on the Network Access Identifier (NAI)"</span>, <span class="seriesInfo">RFC 7585</span>, <span class="seriesInfo">DOI 10.17487/RFC7585</span>, <time datetime="2015-10" class="refDate">October 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc7585">https://www.rfc-editor.org/rfc/rfc7585</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8174">[RFC8174]</dt>
        <dd>
<span class="refAuthor">Leiba, B.</span>, <span class="refTitle">"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 8174</span>, <span class="seriesInfo">DOI 10.17487/RFC8174</span>, <time datetime="2017-05" class="refDate">May 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8174">https://www.rfc-editor.org/rfc/rfc8174</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8446">[RFC8446]</dt>
        <dd>
<span class="refAuthor">Rescorla, E.</span>, <span class="refTitle">"The Transport Layer Security (TLS) Protocol Version 1.3"</span>, <span class="seriesInfo">RFC 8446</span>, <span class="seriesInfo">DOI 10.17487/RFC8446</span>, <time datetime="2018-08" class="refDate">August 2018</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8446">https://www.rfc-editor.org/rfc/rfc8446</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9147">[RFC9147]</dt>
        <dd>
<span class="refAuthor">Rescorla, E.</span>, <span class="refAuthor">Tschofenig, H.</span>, and <span class="refAuthor">N. Modadugu</span>, <span class="refTitle">"The Datagram Transport Layer Security (DTLS) Protocol Version 1.3"</span>, <span class="seriesInfo">RFC 9147</span>, <span class="seriesInfo">DOI 10.17487/RFC9147</span>, <time datetime="2022-04" class="refDate">April 2022</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc9147">https://www.rfc-editor.org/rfc/rfc9147</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9293">[RFC9293]</dt>
        <dd>
<span class="refAuthor">Eddy, W., Ed.</span>, <span class="refTitle">"Transmission Control Protocol (TCP)"</span>, <span class="seriesInfo">STD 7</span>, <span class="seriesInfo">RFC 9293</span>, <span class="seriesInfo">DOI 10.17487/RFC9293</span>, <time datetime="2022-08" class="refDate">August 2022</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc9293">https://www.rfc-editor.org/rfc/rfc9293</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9325">[RFC9325]</dt>
        <dd>
<span class="refAuthor">Sheffer, Y.</span>, <span class="refAuthor">Saint-Andre, P.</span>, and <span class="refAuthor">T. Fossati</span>, <span class="refTitle">"Recommendations for Secure Use of Transport Layer Security (TLS) and Datagram Transport Layer Security (DTLS)"</span>, <span class="seriesInfo">BCP 195</span>, <span class="seriesInfo">RFC 9325</span>, <span class="seriesInfo">DOI 10.17487/RFC9325</span>, <time datetime="2022-11" class="refDate">November 2022</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc9325">https://www.rfc-editor.org/rfc/rfc9325</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9525">[RFC9525]</dt>
      <dd>
<span class="refAuthor">Saint-Andre, P.</span> and <span class="refAuthor">R. Salz</span>, <span class="refTitle">"Service Identity in TLS"</span>, <span class="seriesInfo">RFC 9525</span>, <span class="seriesInfo">DOI 10.17487/RFC9525</span>, <time datetime="2023-11" class="refDate">November 2023</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc9525">https://www.rfc-editor.org/rfc/rfc9525</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</div>
<div id="sec-informative-references">
<section id="section-10.2">
        <h3 id="name-informative-references">
<a href="#section-10.2" class="section-number selfRef">10.2. </a><a href="#name-informative-references" class="section-name selfRef">Informative References</a>
        </h3>
<dl class="references">
<dt id="I-D.ietf-radext-radiusv11">[I-D.ietf-radext-radiusv11]</dt>
        <dd>
<span class="refAuthor">DeKok, A.</span>, <span class="refTitle">"RADIUS/1.1, Leveraging ALPN to remove MD5"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-radext-radiusv11-11</span>, <time datetime="2024-10-18" class="refDate">18 October 2024</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-radext-radiusv11-11">https://datatracker.ietf.org/doc/html/draft-ietf-radext-radiusv11-11</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-radext-tls-psk">[I-D.ietf-radext-tls-psk]</dt>
        <dd>
<span class="refAuthor">DeKok, A.</span>, <span class="refTitle">"Operational Considerations for RADIUS and TLS-PSK"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-radext-tls-psk-12</span>, <time datetime="2025-01-21" class="refDate">21 January 2025</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-radext-tls-psk-12">https://datatracker.ietf.org/doc/html/draft-ietf-radext-tls-psk-12</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-tls-keylogfile">[I-D.ietf-tls-keylogfile]</dt>
        <dd>
<span class="refAuthor">Thomson, M.</span>, <span class="refAuthor">Rosomakho, Y.</span>, and <span class="refAuthor">H. Tschofenig</span>, <span class="refTitle">"The SSLKEYLOGFILE Format for TLS"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-tls-keylogfile-03</span>, <time datetime="2025-02-04" class="refDate">4 February 2025</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-tls-keylogfile-03">https://datatracker.ietf.org/doc/html/draft-ietf-tls-keylogfile-03</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6613">[RFC6613]</dt>
        <dd>
<span class="refAuthor">DeKok, A.</span>, <span class="refTitle">"RADIUS over TCP"</span>, <span class="seriesInfo">RFC 6613</span>, <span class="seriesInfo">DOI 10.17487/RFC6613</span>, <time datetime="2012-05" class="refDate">May 2012</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc6613">https://www.rfc-editor.org/rfc/rfc6613</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6614">[RFC6614]</dt>
        <dd>
<span class="refAuthor">Winter, S.</span>, <span class="refAuthor">McCauley, M.</span>, <span class="refAuthor">Venaas, S.</span>, and <span class="refAuthor">K. Wierenga</span>, <span class="refTitle">"Transport Layer Security (TLS) Encryption for RADIUS"</span>, <span class="seriesInfo">RFC 6614</span>, <span class="seriesInfo">DOI 10.17487/RFC6614</span>, <time datetime="2012-05" class="refDate">May 2012</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc6614">https://www.rfc-editor.org/rfc/rfc6614</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7360">[RFC7360]</dt>
        <dd>
<span class="refAuthor">DeKok, A.</span>, <span class="refTitle">"Datagram Transport Layer Security (DTLS) as a Transport Layer for RADIUS"</span>, <span class="seriesInfo">RFC 7360</span>, <span class="seriesInfo">DOI 10.17487/RFC7360</span>, <time datetime="2014-09" class="refDate">September 2014</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc7360">https://www.rfc-editor.org/rfc/rfc7360</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7593">[RFC7593]</dt>
      <dd>
<span class="refAuthor">Wierenga, K.</span>, <span class="refAuthor">Winter, S.</span>, and <span class="refAuthor">T. Wolniewicz</span>, <span class="refTitle">"The eduroam Architecture for Network Roaming"</span>, <span class="seriesInfo">RFC 7593</span>, <span class="seriesInfo">DOI 10.17487/RFC7593</span>, <time datetime="2015-09" class="refDate">September 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc7593">https://www.rfc-editor.org/rfc/rfc7593</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</div>
</section>
</div>
<div id="lessons_learned">
<section id="appendix-A">
      <h2 id="name-lessons-learned-from-deploy">
<a href="#appendix-A" class="section-number selfRef">Appendix A. </a><a href="#name-lessons-learned-from-deploy" class="section-name selfRef">Lessons learned from deployments of the Experimental <span class="cite xref">[RFC6614]</span></a>
      </h2>
<p id="appendix-A-1">There are at least two major (world-scale) deployments of <span>[<a href="#RFC6614" class="cite xref">RFC6614</a>]</span>.
This section will discuss lessens learned from these deployments, that influenced this document.<a href="#appendix-A-1" class="pilcrow">¶</a></p>
<div id="eduroam">
<section id="appendix-A.1">
        <h3 id="name-eduroam">
<a href="#appendix-A.1" class="section-number selfRef">A.1. </a><a href="#name-eduroam" class="section-name selfRef">eduroam</a>
        </h3>
<p id="appendix-A.1-1">eduroam is a globally operating Wi-Fi roaming consortium exclusively for persons in Research and Education. For an extensive background on eduroam and its authentication fabric architecture, refer to <span>[<a href="#RFC7593" class="cite xref">RFC7593</a>]</span>.<a href="#appendix-A.1-1" class="pilcrow">¶</a></p>
<p id="appendix-A.1-2">Over time, more than a dozen out of 100+ national branches of eduroam used RADIUS/TLS in production to secure their country-to-country RADIUS proxy connections. This number is big enough to attest that the protocol does work, and scales. The number is also low enough to wonder why RADIUS/UDP continued to be used by a majority of country deployments despite its significant security issues.<a href="#appendix-A.1-2" class="pilcrow">¶</a></p>
<p id="appendix-A.1-3">Operational experience reveals that the main reason is related to the choice of PKIX certificates for securing the proxy interconnections. Compared to shared secrets, certificates are more complex to handle in multiple dimensions:<a href="#appendix-A.1-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-A.1-4.1">
            <p id="appendix-A.1-4.1.1">Lifetime: PKIX certificates have an expiry date, and need administrator attention and expertise for their renewal<a href="#appendix-A.1-4.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-A.1-4.2">
            <p id="appendix-A.1-4.2.1">Validation: The validation of a certificate (both client and server) requires contacting a third party to verify the revocation status. This either takes time during session setup (OCSP checks) or requires the presence of a fresh CRL on the server - this in turn requires regular update of that CRL.<a href="#appendix-A.1-4.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-A.1-4.3">
            <p id="appendix-A.1-4.3.1">Issuance: PKIX certificates carry properties in the Subject and extensions that need to be vetted. Depending on the CA policy, a certificate request may need significant human intervention to be verified. In particular, the authorisation of a requester to operate a server for a particular NAI realm needs to be verified. This rules out public "browser-trusted" CAs; eduroam is operating a special-purpose CA for eduroam RADIUS/TLS purposes.<a href="#appendix-A.1-4.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-A.1-4.4">
            <p id="appendix-A.1-4.4.1">Automatic failure over time: CRL refresh and certificate renewal must be attended to regularly. Failure to do so leads to failure of the authentication service. Among other reasons, employee churn with incorrectly transferred or forgotten responsibilities is a risk factor.<a href="#appendix-A.1-4.4.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="appendix-A.1-5">It appears that these complexities often outweigh the argument of improved security; and a fallback to RADIUS/UDP is seen as the more appealing option.<a href="#appendix-A.1-5" class="pilcrow">¶</a></p>
<p id="appendix-A.1-6">It can be considered an important result of the experiment in <span>[<a href="#RFC6614" class="cite xref">RFC6614</a>]</span> that providing less complex ways of operating RADIUS/TLS are required. The more thoroughly specified provisions in the current document towards TLS-PSK and raw public keys are a response to this insight.<a href="#appendix-A.1-6" class="pilcrow">¶</a></p>
<p id="appendix-A.1-7">On the other hand, using RADIUS/TLS in combination with Dynamic Discovery as per <span>[<a href="#RFC7585" class="cite xref">RFC7585</a>]</span> necessitates the use of PKIX certificates. So, the continued ability to operate with PKIX certificates is also important and cannot be discontinued without sacrificing vital functionality of large roaming consortia.<a href="#appendix-A.1-7" class="pilcrow">¶</a></p>
</section>
</div>
<div id="wireless-broadband-alliances-openroaming">
<section id="appendix-A.2">
        <h3 id="name-wireless-broadband-alliance">
<a href="#appendix-A.2" class="section-number selfRef">A.2. </a><a href="#name-wireless-broadband-alliance" class="section-name selfRef">Wireless Broadband Alliance's OpenRoaming</a>
        </h3>
<p id="appendix-A.2-1">OpenRoaming is a globally operating Wi-Fi roaming consortium for the general public, operated by the Wireless Broadband Alliance (WBA). With its (optional) settled usage of hotspots, the consortium requires both RADIUS authentication as well as RADIUS accounting.<a href="#appendix-A.2-1" class="pilcrow">¶</a></p>
<p id="appendix-A.2-2">The consortium operational procedures were defined in the late 2010s when <span>[<a href="#RFC6614" class="cite xref">RFC6614</a>]</span> and <span>[<a href="#RFC7585" class="cite xref">RFC7585</a>]</span> were long available. The consortium decided to fully base itself on these two RFCs.<a href="#appendix-A.2-2" class="pilcrow">¶</a></p>
<p id="appendix-A.2-3">In this architecture, using PSKs or raw public keys is not an option. The complexities around PKIX certificates as discussed in the previous section are believed to be controllable: the consortium operates its own special-purpose CA and can rely on a reliable source of truth for operator authorisation (becoming an operator requires a paid membership in WBA); expiry and revocation topics can be expected to be dealt with as high-priority because of the monetary implications in case of infrastructure failure during settled operation.<a href="#appendix-A.2-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="participating-in-more-than-one-roaming-consortium">
<section id="appendix-A.3">
        <h3 id="name-participating-in-more-than-">
<a href="#appendix-A.3" class="section-number selfRef">A.3. </a><a href="#name-participating-in-more-than-" class="section-name selfRef">Participating in more than one roaming consortium</a>
        </h3>
<p id="appendix-A.3-1">It is possible for a RADIUS/TLS (home) server to participate in more than one roaming consortium, i.e. to authenticate its users to multiple clients from distinct consortia, which present client certificates from their respective consortium's CA; and which expect the server to present a certificate from the matching CA.<a href="#appendix-A.3-1" class="pilcrow">¶</a></p>
<p id="appendix-A.3-2">The eduroam consortium has chosen to cooperate with (the settlement-free parts of) OpenRoaming to allow eduroam users to log in to (settlement-free) OpenRoaming hotspots.<a href="#appendix-A.3-2" class="pilcrow">¶</a></p>
<p id="appendix-A.3-3">eduroam RADIUS/TLS servers thus may be contacted by OpenRoaming clients expecting an OpenRoaming server certificate, and by eduroam clients expecting an eduroam server certificate.<a href="#appendix-A.3-3" class="pilcrow">¶</a></p>
<p id="appendix-A.3-4">It is therefore necessary to decide on the certificate to present during TLS session establishment. To make that decision, the availability of Trusted CA Indication in the client TLS message is important.<a href="#appendix-A.3-4" class="pilcrow">¶</a></p>
<p id="appendix-A.3-5">It can be considered an important result of the experiment in <span>[<a href="#RFC6614" class="cite xref">RFC6614</a>]</span> that Trusted CA Indication is an important asset for inter-connectivity of multiple roaming consortia.<a href="#appendix-A.3-5" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="interoperable-implementations">
<section id="appendix-B">
      <h2 id="name-interoperable-implementatio">
<a href="#appendix-B" class="section-number selfRef">Appendix B. </a><a href="#name-interoperable-implementatio" class="section-name selfRef">Interoperable Implementations</a>
    </h2>
</section>
</div>
<div id="backwardcomp">
<section id="appendix-C">
      <h2 id="name-backward-compatibility">
<a href="#appendix-C" class="section-number selfRef">Appendix C. </a><a href="#name-backward-compatibility" class="section-name selfRef">Backward compatibility</a>
      </h2>
<p id="appendix-C-1">TODO describe necessary steps to configure common servers for compatibility with this version.
Hopefully the differences to <span>[<a href="#RFC6614" class="cite xref">RFC6614</a>]</span> are small enough that almost no config change is necessary.<a href="#appendix-C-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="acknowledgments">
<section id="appendix-D">
      <h2 id="name-acknowledgments">
<a href="#name-acknowledgments" class="section-name selfRef">Acknowledgments</a>
      </h2>
<p id="appendix-D-1">Thanks to the original authors of RFC 6613, RFC 6614 and RFC 7360: Alan DeKok, Stefan Winter, Mike McCauley, Stig Venaas and Klaas Vierenga.<a href="#appendix-D-1" class="pilcrow">¶</a></p>
<p id="appendix-D-2">Thanks to Arran Curdbard-Bell for text around keepalives and the Status-Server watchdog algorithm.<a href="#appendix-D-2" class="pilcrow">¶</a></p>
<p id="appendix-D-3">Thanks to Alan DeKok for his constant review of this document over its whole process and his many text contributions, like text around forwarding issues between TCP and UDP based transports.<a href="#appendix-D-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="authors-addresses">
<section id="appendix-E">
      <h2 id="name-authors-addresses">
<a href="#name-authors-addresses" class="section-name selfRef">Authors' Addresses</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Jan-Frederik Rieckers</span></div>
<div dir="auto" class="left"><span class="org">Deutsches Forschungsnetz | German National Research and Education Network</span></div>
<div dir="auto" class="left"><span class="street-address">Alexanderplatz 1</span></div>
<div dir="auto" class="left">
<span class="postal-code">10178</span> <span class="locality">Berlin</span>
</div>
<div dir="auto" class="left"><span class="country-name">Germany</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:rieckers@dfn.de" class="email">rieckers@dfn.de</a>
</div>
<div class="url">
<span>URI:</span>
<a href="www.dfn.de" class="url">www.dfn.de</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Stefan Winter</span></div>
<div dir="auto" class="left"><span class="org">Fondation Restena | Restena Foundation</span></div>
<div dir="auto" class="left"><span class="street-address">2, avenue de l'Université</span></div>
<div dir="auto" class="left">L-<span class="postal-code">4365</span> <span class="locality">Esch-sur-Alzette</span>
</div>
<div dir="auto" class="left"><span class="country-name">Luxembourg</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:stefan.winter@restena.lu" class="email">stefan.winter@restena.lu</a>
</div>
<div class="url">
<span>URI:</span>
<a href="www.restena.lu" class="url">www.restena.lu</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>
</body>
</html>
